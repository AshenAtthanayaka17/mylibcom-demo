<!DOCTYPE html>
<html lang="enGB">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mylibcom - Digital Library</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/10.14.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.14.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.14.1/firebase-firestore-compat.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="icon" type="image/png" href="https://img.icons8.com/?size=100&id=PaMqeFJp6WDW&format=png&color=000000">
    <!--Update me iywn Logo -->

    <!--Seasonal effects-->
    <div id="snowflakeContainer">
        <div class="snowflake">‚ùÖ</div>
        <div class="snowflake">‚ùÜ</div>
        <div class="snowflake">‚ùÖ</div>
        <div class="snowflake">‚ùÜ</div>
        <div class="snowflake">‚ùÖ</div>
        <div class="snowflake">‚ùÜ</div>
        <div class="snowflake">‚ùÖ</div>
        <div class="snowflake">‚ùÜ</div>
        <div class="snowflake">‚ùÖ</div>
        <div class="snowflake">‚ùÜ</div>
        <div class="snowflake">‚ùÖ</div>
        <div class="snowflake">‚ùÜ</div>
    </div>

    <style>
        /* Snowflakes Container */
        #snowflakeContainer {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 9999;
        }

        /* Individual Snowflake */
        .snowflake {
            position: absolute;
            top: -10px;
            color: #fff;
            font-size: 1.2em;
            user-select: none;
            animation: fall linear infinite;
            opacity: 0.9;
        }

        @keyframes fall {
            0% {
                transform: translateY(-100vh) rotate(0deg);
                opacity: 0;
            }

            10% {
                opacity: 0.9;
            }

            90% {
                opacity: 0.9;
            }

            100% {
                transform: translateY(100vh) rotate(360deg);
                opacity: 0;
            }
        }

        /* Randomize each snowflake */
        .snowflake:nth-child(1) {
            left: 10%;
            animation-duration: 12s;
            animation-delay: 0s;
            font-size: 1.4em;
        }

        .snowflake:nth-child(2) {
            left: 20%;
            animation-duration: 15s;
            animation-delay: 2s;
            font-size: 1em;
        }

        .snowflake:nth-child(3) {
            left: 30%;
            animation-duration: 10s;
            animation-delay: 5s;
            font-size: 1.6em;
        }

        .snowflake:nth-child(4) {
            left: 40%;
            animation-duration: 18s;
            animation-delay: 1s;
            font-size: 1.2em;
        }

        .snowflake:nth-child(5) {
            left: 50%;
            animation-duration: 14s;
            animation-delay: 8s;
            font-size: 1.5em;
        }

        .snowflake:nth-child(6) {
            left: 60%;
            animation-duration: 11s;
            animation-delay: 3s;
            font-size: 1em;
        }

        .snowflake:nth-child(7) {
            left: 70%;
            animation-duration: 16s;
            animation-delay: 6s;
            font-size: 1.3em;
        }

        .snowflake:nth-child(8) {
            left: 80%;
            animation-duration: 13s;
            animation-delay: 4s;
            font-size: 1.7em;
        }

        .snowflake:nth-child(9) {
            left: 90%;
            animation-duration: 17s;
            animation-delay: 7s;
            font-size: 1.1em;
        }

        .snowflake:nth-child(10) {
            left: 15%;
            animation-duration: 19s;
            animation-delay: 9s;
            font-size: 1.4em;
        }

        .snowflake:nth-child(11) {
            left: 55%;
            animation-duration: 12s;
            animation-delay: 1s;
            font-size: 1.6em;
        }

        .snowflake:nth-child(12) {
            left: 85%;
            animation-duration: 14s;
            animation-delay: 5s;
            font-size: 1.2em;
        }
    </style>
    <!-- End of Seasonal effects-->
    <!--to activate remove extra functions before "div Id " & after "Style"-->
    <!--to reactivate follow visvrsa-->


    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700;800&display=swap');
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+Sinhala:wght@400;700&display=swap');

        body {
            font-family: 'Inter', 'Noto Sans Sinhala', sans-serif;
            background-color: #0f172a;
            /* Slate 900 */
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: #1e293b;
        }

        ::-webkit-scrollbar-thumb {
            background: #475569;
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #64748b;
        }

        .card-hover:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.5);
        }

        .line-clamp-2 {
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .line-clamp-3 {
            display: -webkit-box;
            -webkit-line-clamp: 3;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        /* Category Badges Colors */
        .cat-Children {
            background-color: #22c55e;
            color: white;
        }

        /* Green */
        .cat-Teens {
            background-color: #eab308;
            color: black;
        }

        /* Yellow */
        .cat-YA {
            background-color: #f97316;
            color: white;
        }

        /* Orange */
        .cat-Adult {
            background-color: #ef4444;
            color: white;
        }

        /* Red */
        .cat-Academic {
            background-color: #3b82f6;
            color: white;
        }

        /* Blue */
        .cat-Unspecified {
            background-color: #ffffff;
            color: black;
        }

        /* White */

        /* Availability Status Styles */
        .status-available {
            color: #34d399;
        }

        /* Emerald 400 */
        .status-checked-out {
            color: #f87171;
        }

        /* Red 400 */

        /* Dim card if checked out */
        .card-unavailable img {
            filter: grayscale(100%);
            opacity: 0.6;
        }

        .fade-in {
            animation: fadeIn 0.5s ease-in-out;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* New Status Badges */
        .status-new {
            background: linear-gradient(135deg, #10b981, #34d399);
            color: black;
            font-weight: 900;
            animation: pulse 2s infinite;
        }

        .status-leaving {
            background: linear-gradient(135deg, #f59e0b, #f97316);
            color: white;
            font-weight: 900;
            animation: pulse-warning 2s infinite;
        }

        @keyframes pulse {

            0%,
            100% {
                opacity: 1;
            }

            50% {
                opacity: 0.8;
            }
        }

        @keyframes pulse-warning {

            0%,
            100% {
                opacity: 1;
                transform: scale(1);
            }

            50% {
                opacity: 0.9;
                transform: scale(1.05);
            }
        }
    </style>
</head>

<body class="text-slate-200">

    <!-- Update Site Notice Here -->
    <h6 class="text-center text-yellow-400 font-bold py-2 bg-red-900">üîî Site will be offline from 30th Nov to 26th Dec
        due to server changes !</h6>

    <!-- Navbar -->
    <nav class="sticky top-0 z-50 bg-slate-900/95 backdrop-blur-md border-b border-slate-800 shadow-lg">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-16">
                <div class="flex items-center gap-3 cursor-pointer" onclick="resetApp()">
                    <i class="fa-solid fa-book-open text-3xl text-emerald-500"></i>
                    <span class="text-xl font-bold tracking-wide text-white">Mylib<span
                            class="text-emerald-500">Com</span></span>
                </div>

                <!-- Desktop Search -->
                <div class="hidden md:block flex-1 max-w-md mx-4">
                    <div class="relative">
                        <span class="absolute inset-y-0 left-0 flex items-center pl-3">
                            <i class="fa-solid fa-magnifying-glass text-slate-500"></i>
                        </span>
                        <input type="text" id="searchInput" placeholder="Search titles, authors, or genres..."
                            class="w-full bg-slate-800 text-white border border-slate-700 rounded-full py-2 pl-10 pr-4 focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-transparent placeholder-slate-500 transition-all">
                    </div>
                </div>

                <!-- User Auth Menue -->
                <div class="flex items-center gap-6" id="authSection">
                    <!-- Firebase will replace this -->
                </div>
                <button onclick="showAccount()" class="text-emerald-400 hover:text-emerald-300 hidden" id="accountBtn">
                    <i class="fa-solid fa-user-circle text-2xl"></i>
                </button>

                <!-- Mobile Filter Button -->
                <div class="md:hidden">
                    <button id="mobileMenuBtn" class="text-slate-300 hover:text-white">
                        <i class="fa-solid fa-sliders text-xl"></i>
                    </button>
                </div>
            </div>
        </div>

        <!-- Mobile Search (Expandable) -->
        <div id="mobileSearchPanel" class="hidden md:hidden border-t border-slate-800 bg-slate-900 p-4">
            <input type="text" id="mobileSearchInput" placeholder="Search here..."
                class="w-full bg-slate-800 text-white border border-slate-700 rounded-lg py-2 px-4 focus:ring-2 focus:ring-emerald-500">
        </div>
    </nav>

    <!-- Main Content -->
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">

        <!-- Filters & Stats -->
        <div class="flex flex-col md:flex-row md:items-center justify-between gap-4 mb-8">

            <!-- Filter Tags -->
            <div class="flex flex-wrap gap-2" id="genreFilters">
                <button onclick="filterByGenre('All')"
                    class="px-4 py-1.5 rounded-full text-sm font-medium bg-emerald-600 text-white shadow-lg shadow-emerald-500/30 transition-all hover:bg-emerald-500 active-filter">All</button>
                <button onclick="filterByGenre('Poetry')"
                    class="px-4 py-1.5 rounded-full text-sm font-medium bg-slate-800 text-slate-300 hover:bg-slate-700 transition-all">Poetry</button>
                <button onclick="filterByGenre('Fiction')"
                    class="px-4 py-1.5 rounded-full text-sm font-medium bg-slate-800 text-slate-300 hover:bg-slate-700 transition-all">Fiction</button>
                <button onclick="filterByGenre('Fantasy')"
                    class="px-4 py-1.5 rounded-full text-sm font-medium bg-slate-800 text-slate-300 hover:bg-slate-700 transition-all">Fantasy</button>
                <button onclick="filterByGenre('Sci-Fi')"
                    class="px-4 py-1.5 rounded-full text-sm font-medium bg-slate-800 text-slate-300 hover:bg-slate-700 transition-all">Sci-Fi</button>
                <button onclick="filterByGenre('Mystery')"
                    class="px-4 py-1.5 rounded-full text-sm font-medium bg-slate-800 text-slate-300 hover:bg-slate-700 transition-all">Mystery</button>
                <button onclick="filterByGenre('Classic')"
                    class="px-4 py-1.5 rounded-full text-sm font-medium bg-slate-800 text-slate-300 hover:bg-slate-700 transition-all">Classic</button>
                <button onclick="filterByGenre('Non-Fiction')"
                    class="px-4 py-1.5 rounded-full text-sm font-medium bg-slate-800 text-slate-300 hover:bg-slate-700 transition-all">Non-Fiction</button>
                <button onclick="filterByGenre('Horror')"
                    class="px-4 py-1.5 rounded-full text-sm font-medium bg-slate-800 text-slate-300 hover:bg-slate-700 transition-all">Horror</button>
                <button onclick="filterByGenre('Novel')"
                    class="px-4 py-1.5 rounded-full text-sm font-medium bg-slate-800 text-slate-300 hover:bg-slate-700 transition-all">Novels</button>
                <button onclick="filterByGenre('Romance')"
                    class="px-4 py-1.5 rounded-full text-sm font-medium bg-slate-800 text-slate-300 hover:bg-slate-700 transition-all">Romance</button>
                <button onclick="filterByGenre('Miscellaneous')"
                    class="px-4 py-1.5 rounded-full text-sm font-medium bg-slate-800 text-slate-300 hover:bg-slate-700 transition-all">Miscellaneous</button>
                <button onclick="filterByGenre('Religion')"
                    class="px-4 py-1.5 rounded-full text-sm font-medium bg-slate-800 text-slate-300 hover:bg-slate-700 transition-all">Religion</button>
            </div>

            <!-- Sort/Count -->
            <div class="flex items-center justify-between md:justify-end w-full md:w-auto text-slate-400 text-sm">
                <span id="bookCount">Showing 0 books</span>
                <div class="ml-4 flex items-center gap-2">
                    <label for="sortSelect">Sort Options:</label>
                    <select id="sortSelect"
                        class="bg-slate-800 border-none rounded text-slate-200 text-sm focus:ring-1 focus:ring-emerald-500 py-1 px-2 cursor-pointer">
                        <option value="newest">Newest</option>
                        <option value="oldest">Oldest</option>
                        <option value="rating">Top Rated</option>
                        <option value="available">Available First</option>
                    </select>
                </div>
            </div>
        </div>

        <!-- Book Grid -->
        <div id="bookGrid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6">
            <!-- Book Cards will be injected here -->
        </div>

        <!-- My Account Page -->
        <div id="accountPage" class="hidden max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
            <div class="flex items-center justify-between mb-8">
                <h1 class="text-3xl font-bold text-white">My Account</h1>
                <button onclick="showHome()" class="text-emerald-400 hover:text-emerald-300">
                    <i class="fa-solid fa-arrow-left mr-2"></i>Back to Library
                </button>
            </div>

            <div class="grid md:grid-cols-2 gap-8">
                <!-- Wishlist -->
                <div class="bg-slate-800 rounded-2xl p-6 border border-slate-700">
                    <h2 class="text-xl font-bold text-emerald-400 mb-4 flex items-center gap-2">
                        <i class="fa-solid fa-heart"></i> My Wishlist
                    </h2>
                    <div id="wishlistContainer" class="space-y-3">
                        <p class="text-slate-500">Loading your wishlist...</p>
                    </div>
                </div>

                <!-- Borrowed Books -->
                <div class="bg-slate-800 rounded-2xl p-6 border border-slate-700">
                    <h2 class="text-xl font-bold text-yellow-400 mb-4 flex items-center gap-2">
                        <i class="fa-solid fa-book-bookmark"></i> Borrowed Books
                    </h2>
                    <div id="borrowedContainer" class="space-y-3">
                        <p class="text-slate-500">No books borrowed yet.</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- No Results State -->
        <div id="noResults" class="hidden flex flex-col items-center justify-center py-20 text-slate-500">
            <i class="fa-solid fa-book-open text-6xl mb-4 opacity-20"></i>
            <p class="text-xl font-semibold">No books found</p>
            <p class="text-sm">Try adjusting your search or filters.</p>
            <button onclick="resetApp()" class="mt-4 text-emerald-400 hover:text-emerald-300 underline">Clear all
                filters</button>
        </div>

    </div>

    <!-- Footer -->
    <footer class="bg-slate-950 border-t border-slate-800 pt-16 pb-8 mt-12">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="grid grid-cols-1 md:grid-cols-3 gap-12 mb-12">
                <!-- Brand & Credits -->
                <div>
                    <div class="flex items-center gap-2 mb-4">
                        <i class="fa-solid fa-book-open text-2xl text-emerald-500"></i>
                        <span class="text-xl font-bold tracking-wide text-white">Mylib<span
                                class="text-emerald-500">Com</span></span>
                    </div>
                    <p class="text-slate-400 text-sm leading-relaxed mb-6">
                        Perfect platform to find out if it is worth reading that book in your mind.
                    </p>
                    <div class="text-sm text-slate-500 border-l-2 border-emerald-500 pl-3">
                        <p class="font-medium text-slate-300">Credits</p>
                        <p>Designed & Developed by <span class="text-emerald-400">Ashen Atthanayaka</span></p>
                        <p class="text-xs mt-1">Icons by FontAwesome & Images by Katha.lk & Goodreads.com</p>
                    </div>
                </div>

                <!-- Site Priorities / Quick Links -->
                <div>
                    <h3 class="text-white font-bold text-lg mb-6 flex items-center gap-2">
                        <i class="fa-solid fa-shield-halved text-emerald-500 text-sm"></i> Site Priorities
                    </h3>
                    <ul class="space-y-3 text-sm text-slate-400">
                        <li><a href="https://ashenatthanayaka17.github.io/mylibcom-privacypolicy/"
                                class="hover:text-emerald-400 transition-colors flex items-center gap-2"><i
                                    class="fa-solid fa-chevron-right text-xs text-slate-600"></i> User Privacy
                                Policy</a></li>
                        <li><a href="https://ashenatthanayaka17.github.io/mylibcom-drm"
                                class="hover:text-emerald-400 transition-colors flex items-center gap-2"><i
                                    class="fa-solid fa-chevron-right text-xs text-slate-600"></i> Digital Rights
                                Management</a></li>
                        <li><a href="https://ashenatthanayaka17.github.io/mylibcom-accessability/"
                                class="hover:text-emerald-400 transition-colors flex items-center gap-2"><i
                                    class="fa-solid fa-chevron-right text-xs text-slate-600"></i> Accessibility
                                Statement</a></li>
                        <li><a href="https://ashenatthanayaka17.github.io/mylibcom-communityguidelines/"
                                class="hover:text-emerald-400 transition-colors flex items-center gap-2"><i
                                    class="fa-solid fa-chevron-right text-xs text-slate-600"></i> Community
                                Guidelines</a></li>
                        <li><a href="https://ashenatthanayaka17.github.io/mylibcom-tnc/"
                                class="hover:text-emerald-400 transition-colors flex items-center gap-2"><i
                                    class="fa-solid fa-chevron-right text-xs text-slate-600"></i> Terms of Service</a>
                        </li>
                    </ul>
                </div>

                <!-- Contact Us -->
                <div>
                    <h3 class="text-white font-bold text-lg mb-6 flex items-center gap-2">
                        <i class="fa-solid fa-headset text-emerald-500 text-sm"></i> Contact Us
                    </h3>
                    <ul class="space-y-4 text-sm text-slate-400">
                        <li class="flex items-start gap-3">
                            <div class="mt-1 bg-slate-800 p-1.5 rounded text-emerald-500"><i
                                    class="fa-solid fa-location-dot"></i></div>
                            <span>21A Islington Park Street,<br>London, N1 1QB,<br>United Kingdom</span>
                        </li>
                        <li class="flex items-center gap-3">
                            <div class="bg-slate-800 p-1.5 rounded text-emerald-500"><i class="fa-solid fa-phone"></i>
                            </div>
                            <span>+44 7418 315820<br>+44 2087 967679</span>
                        </li>
                        <li class="flex items-center gap-3">
                            <div class="bg-slate-800 p-1.5 rounded text-emerald-500"><i
                                    class="fa-solid fa-envelope"></i></div>
                            <span>admin@mylibcom.co.uk</span>
                        </li>
                    </ul>
                    <!-- Socials -->
                    <div class="flex gap-3 mt-6">
                        <a href="https://www.facebook.com/a3target5Alpha/"
                            class="w-9 h-9 rounded-lg bg-slate-800 flex items-center justify-center text-slate-400 hover:bg-blue-600 hover:text-white transition-all transform hover:-translate-y-1">
                            <i class="fa-brands fa-facebook-f"></i>
                        </a>
                        <a href="https://ashenatthanayaka17.github.io/mylibcom-chatwithus/"
                            class="w-9 h-9 rounded-lg bg-slate-800 flex items-center justify-center text-slate-400 hover:bg-sky-500 hover:text-white transition-all transform hover:-translate-y-1">
                            <i class="fa-brands fa-whatsapp"></i>
                        </a>
                        <a href="https://www.instagram.com/ashenatthanayaka17/"
                            class="w-9 h-9 rounded-lg bg-slate-800 flex items-center justify-center text-slate-400 hover:bg-pink-600 hover:text-white transition-all transform hover:-translate-y-1">
                            <i class="fa-brands fa-instagram"></i>
                        </a>
                        <a href="#"
                            class="w-9 h-9 rounded-lg bg-slate-800 flex items-center justify-center text-slate-400 hover:bg-blue-700 hover:text-white transition-all transform hover:-translate-y-1">
                            <i class="fa-brands fa-youtube"></i>
                        </a>
                    </div>
                </div>
            </div>

            <!-- Bottom Bar -->
            <div
                class="border-t border-slate-800 pt-8 flex flex-col md:flex-row justify-between items-center gap-4 text-xs text-slate-500">
                <p>&copy; 2024 Mylibcom. All rights reserved.</p>
                <div class="flex flex-wrap justify-center gap-6">
                    <span>Ratings for your favourite books</span>
                    <span class="hidden md:inline text-slate-700">|</span>
                    <span>Server Time: GMT +0:00</span>
                </div>
            </div>
        </div>
    </footer>

    <!-- Modal -->
    <div id="bookModal" class="fixed inset-0 z-[100] hidden" aria-labelledby="modal-title" role="dialog"
        aria-modal="true">
        <!-- Background backdrop -->
        <div class="fixed inset-0 bg-slate-900/90 backdrop-blur-sm transition-opacity" onclick="closeModal()"></div>

        <div class="fixed inset-0 z-10 overflow-y-auto">
            <div class="flex min-h-full items-center justify-center p-4 text-center sm:p-0">
                <div
                    class="relative transform overflow-hidden rounded-2xl bg-slate-800 text-left shadow-2xl transition-all sm:my-8 sm:w-full sm:max-w-2xl border border-slate-700">

                    <!-- Close Button -->
                    <button onclick="closeModal()"
                        class="absolute top-4 right-4 z-10 p-2 rounded-full bg-black/50 text-white hover:bg-black/70 transition-colors cursor-pointer">
                        <i class="fa-solid fa-xmark text-xl"></i>
                    </button>

                    <div class="flex flex-col md:flex-row">
                        <!-- Modal Image -->
                        <div class="md:w-2/5 h-64 md:h-auto relative bg-slate-900">
                            <div id="modalImagePlaceholder"
                                class="w-full h-full flex items-center justify-center text-slate-700 bg-slate-900 absolute inset-0">
                                <i class="fa-solid fa-book text-4xl"></i>
                            </div>
                            <img id="modalImage" src="" alt="Book Cover"
                                class="absolute inset-0 w-full h-full object-cover relative z-10"
                                onerror="this.style.display='none'; document.getElementById('modalImagePlaceholder').style.display='flex'">
                        </div>

                        <!-- Modal Content -->
                        <div class="md:w-3/5 p-6 md:p-8">
                            <div class="flex items-start justify-between mb-2">
                                <span id="modalGenre"
                                    class="text-xs font-bold tracking-wider uppercase text-emerald-400">Fiction</span>
                                <div class="flex items-center gap-1 text-yellow-400">
                                    <i class="fa-solid fa-star"></i>
                                    <span id="modalRating" class="font-bold text-white">4.8</span>
                                </div>
                            </div>

                            <h3 id="modalTitle" class="text-2xl md:text-3xl font-bold text-white mb-1 leading-tight">
                                Book Title</h3>
                            <p id="modalAuthor" class="text-lg text-slate-300 mb-4 font-medium">by Author Name</p>

                            <div class="flex flex-wrap items-center gap-3 text-sm text-slate-400 mb-6">
                                <span id="modalYear">1999</span>
                                <span>&bull;</span>
                                <span id="modalPages">320 pages</span>
                                <span>&bull;</span>
                                <span id="modalCategory"
                                    class="px-2 py-0.5 rounded text-xs font-bold text-slate-900 bg-slate-200">Adult</span>
                            </div>

                            <div class="space-y-4">
                                <div>
                                    <h4 class="text-sm font-semibold text-slate-300 uppercase tracking-wide mb-1">
                                        Description</h4>
                                    <p id="modalDescription"
                                        class="text-slate-400 leading-relaxed text-sm md:text-base h-24 overflow-y-auto pr-2">
                                        Book description goes here...
                                    </p>
                                </div>

                                <div class="grid grid-cols-2 gap-4 pt-4 border-t border-slate-700/50">
                                    <div>
                                        <h4 class="text-xs font-semibold text-slate-500 uppercase">Track Number</h4>
                                        <p id="modalLocation" class="text-slate-200 text-sm">Shelf A-12</p>
                                    </div>
                                    <div>
                                        <h4 class="text-xs font-semibold text-slate-500 uppercase">Status</h4>
                                        <div id="modalStatus" class="flex items-center text-sm font-bold">
                                            <!-- Status Text -->
                                        </div>
                                    </div>
                                </div>

                                <!-- Action Button -->
                                <div class="pt-4">
                                    <button id="actionButton"
                                        class="w-full text-white font-bold py-3 px-4 rounded-lg transition-colors flex items-center justify-center gap-2 uppercase tracking-wide text-sm shadow-lg">
                                        <!-- Dynamic Button Text -->
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Login / Register Modal -->
        <div id="authModal" class="fixed inset-0 z-[200] hidden">
            <div class="fixed inset-0 bg-slate-900/95 backdrop-blur-sm" onclick="closeAuthModal()"></div>
            <div class="fixed inset-0 flex items-center justify-center p-4">
                <div class="bg-slate-800 rounded-2xl shadow-2xl max-w-md w-full p-8 border border-slate-700">
                    <h2 class="text-2xl font-bold text-white mb-6 text-center" id="authTitle">Login</h2>

                    <div id="authForm">
                        <input type="email" id="authEmail" placeholder="Email"
                            class="w-full bg-slate-700 text-white rounded-lg px-4 py-3 mb-4 focus:ring-2 focus:ring-emerald-500 outline-none">
                        <input type="password" id="authPassword" placeholder="Password"
                            class="w-full bg-slate-700 text-white rounded-lg px-4 py-3 mb-6 focus:ring-2 focus:ring-emerald-500 outline-none">

                        <div class="text-center mt-3">
                            <button onclick="forgotPassword()" class="text-sm text-emerald-400 hover:underline">
                                Forgot password?
                            </button>
                        </div>

                        <div class="my-4">
                            <div class="relative">
                                <div class="absolute inset-0 flex items-center">
                                    <div class="w-full border-t border-slate-600"></div>
                                </div>
                                <div class="relative flex justify-center text-sm">
                                    <span class="px-2 bg-slate-800 text-slate-400">or</span>
                                </div>
                            </div>
                        </div>

                        <button onclick="googleSignIn()"
                            class="w-full bg-white text-black font-medium py-3 rounded-lg flex items-center justify-center gap-3 hover:bg-gray-100 transition">
                            <img src="https://www.gstatic.com/firebasejs/ui/2.0.0/images/auth/google.svg" alt="Google"
                                class="w-5 h-5">
                            Continue with Google
                        </button>

                        <button id="authMainBtn" onclick="login()"
                            class="w-full bg-emerald-600 hover:bg-emerald-500 text-white font-bold py-3 rounded-lg mb-3">
                            Login
                        </button>

                        <p class="text-center text-slate-400 text-sm">
                            <span id="authToggleText">Don't have an account?</span>
                            <button onclick="toggleAuthMode()"
                                class="text-emerald-400 hover:underline font-bold">Register</button>
                        </p>
                    </div>

                    <button onclick="closeAuthModal()" class="absolute top-4 right-4 text-slate-400 hover:text-white">
                        <i class="fa-solid fa-xmark text-xl"></i>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // --- BOOK DATABASE ---
        // TO UPDATE AVAILABILITY: 
        // Find the book in this list and change 'available: true' to 'available: false' (or vice versa).

        const books = [
            {
                id: 1,
                title: "‡∂í‡∂≠‡∑ä ‡∂∏‡∂Ç ‡∂Ü‡∂Ø‡∂ª‡∑ô‡∂∫‡∑í | Eth Man Adarei",
                author: "Abdul Umar Sahan Nethmina",
                genre: "Poetry",
                year: "Unknown",
                rating: 6.8,
                category: "Teens",
                pages: 100,
                location: "MLC/P/0001/TN",
                description: "‡∂ö‡∑Ä‡∂Ø‡∑è‡∑Ñ‡∂ª‡∑í ‡∂Ø‡∑è‡∑Ä‡∑É‡∂ö‡∂Ø‡∑í ‡∂∏‡∑ö ‡∂∏‡∂ú‡∑î‡∂Ω‡∑ä ‡∂ö‡∑í‡∂∫‡∑Ä‡∂Ω‡∑è ‡∂î‡∂∫‡∑è‡∂ß‡∂≠‡∑ä ‡∑Ñ‡∑í‡∂≠‡∑î‡∂±‡∑ú‡∂≠‡∑í‡∂±‡∑ä ‡∂∏‡∂∏ ‡∂¥‡∑í‡∑É‡∑ä‡∑É‡∑ô‡∂ö‡∑ê‡∂∫‡∑í ‡∂ö‡∑í‡∂∫‡∑è ‡∂Ö‡∂Ø ‡∑Ä‡∂ú‡∑ô‡∂∏ ‡∂ë‡∂Ø‡∑è‡∂ß‡∂≠‡∑ä ‡∂≠‡∑í‡∂∫‡∂∏‡∑ä ‡∂ö‡∑Ä‡∑í‡∂∫‡∂ö ‡∂Ω‡∑í‡∂∫‡∑è ‡∂¥‡∑í‡∑É‡∑ä‡∑É‡∑ô‡∂ö‡∑î‡∂ú‡∑ö ‡∂Ü‡∂Ø‡∂ª‡∑ö ‡∂≠‡∑è‡∂∏ ‡∂Ø‡∂±‡∑ä‡∂±‡∑ë ‡∂î‡∂∫‡∑è ",
                image: "https://katha.lk/wp-content/uploads/2024/06/s0251-eth-man-aadarei-abdul-umar-sahan-nethmina.webp",
                available: true,
                status: "" // new arrival: new, Leaving soon: leaving, or null
            },

            {
                id: 2,
                title: "‡∂â‡∂≠‡∑í‡∂Ç ‡∂∏‡∂ß ‡∑É‡∂∏‡∑è‡∑Ä‡∑ô‡∂±‡∑ä‡∂± | Ithin Mata Samawenna",
                author: "Abdul Umar Sahan Nethmina",
                genre: "Poetry",
                year: "Unknown",
                rating: 6.9,
                category: "Teens",
                pages: 62,
                location: "MLC/P/00002/TN",
                description: "‡∂∂‡∑ê‡∂ª‡∑í‡∂∏ ‡∑Ñ‡∑í‡∂±‡∑ä‡∂Ø‡∑è ‡∂ö‡∑Ä‡∂∏‡∂Ø‡∑è‡∑Ä‡∂≠‡∑ä ‡∂Ü‡∂∫‡∑ô ‡∂î‡∂∂ ‡∑Ä‡∑ô‡∂≠ ‡∑Ñ‡∑ê‡∂ª‡∑ô‡∂±‡∑ä‡∂± ‡∂ö‡∑í‡∑É‡∑í‡∂≠‡∑ä ‡∂ö‡∑í‡∂∫‡∂±‡∑ä‡∂± ‡∂∂‡∑ë ‡∂â‡∂≠‡∑í‡∂Ç ‡∂∏‡∂ß, ‚Äú‡∑É‡∂∏‡∑è ‡∑Ä‡∑ô‡∂±‡∑î ‡∂∏‡∑ê‡∂±!‚Äù ‡∂á‡∂ª‡∑ô‡∂±‡∑ä‡∂± ‡∂¢‡∑ì‡∑Ä‡∑í‡∂≠‡∑ö ‡∂≠‡∑Ä ‡∂∂‡∑ú‡∑Ñ‡∑ù ‡∂Ø‡∑î‡∂ª ‡∂á‡∂≠‡∑í ‡∂Ö‡∂≠‡∂ª‡∂∏‡∂ú ‡∂∂‡∑ë ‡∂∏‡∑ê‡∂ª‡∑ô‡∂±‡∑ä‡∂± ‡∂î‡∂∂‡∂≠‡∑ä ‡∂î‡∑Ñ‡∑ú‡∂∏‡∂∏ ‡∂∏‡∂ú‡∂Ø‡∑í ‡∑Ñ‡∂∏‡∑î‡∑Ä‡∂± ‡∑Ä‡∂Ç‡∂ú‡∑î‡∑Ä‡∂ö‡∑ä ‡∑Ö‡∂ü ‡∑Ñ‡∑ê‡∂ª‡∑ô‡∂±‡∑ä‡∂±",
                image: "https://katha.lk/wp-content/uploads/2024/11/s0504-ithin-mata-samawenna-abdul-umar-sahan-nethmina.webp",
                available: true,
                status: "" // new arrival: new, Leaving soon: leaving, or null
            },

            {
                id: 3,
                title: "‡∂í ‡∂Ø‡∑Ä‡∑É‡∑ä ‡∑Ñ‡∂ª‡∑í ‡∑Ä‡∑ô‡∂±‡∑É‡∑ä | E Dawas Hari Wenas",
                author: "Abdul Umar Sahan Nethmina",
                genre: "Novel",
                year: "Unknown",
                rating: 8.8,
                category: "YA",
                pages: 494,
                location: "MLC/N/0003/YA",
                description: "‡∂â‡∑É‡∑ä‡∑É‡∑ô‡∂Ω‡∑ä‡∂Ω‡∑è ‡∂∏ ‡∂î‡∑Ñ‡∑î‡∂ß ‡∂á‡∂∫‡∂ú‡∑ô ‡∑Ñ‡∑ì‡∂±‡∑í ‡∂á‡∂ü‡∑í‡∂Ω‡∑í ‡∂≠‡∑î‡∂©‡∑î‡∑Ä‡∂Ω ‡∑É‡∑ä‡∂¥‡∂ª‡∑ä‡∑Å‡∂∫ ‡∂Ø‡∑ê‡∂±‡∑ô‡∂±‡∑ä‡∂± ‡∂ú‡∂≠‡∑ä‡∂≠‡∑è. ‡∂í‡∂≠‡∑ä ‡∂ë‡∂ö‡∑ä‡∂ö ‡∂∏ ‡∂á‡∂ü‡∑í‡∂Ω‡∑í‡∑Ä‡∂Ω‡∑í‡∂±‡∑ä ‡∂¥‡∂ß‡∂Ç ‡∂ú‡∂≠‡∑ä‡∂≠ ‡∂ã‡∂´‡∑î‡∑É‡∑î‡∂∏‡∂ö‡∑ä ‡∂∏‡∑î‡∂Ω‡∑î ‡∂á‡∂ü ‡∂¥‡∑î‡∂ª‡∑è ‡∂∏ ‡∂¥‡∑ê‡∂≠‡∑í‡∂ª‡∑ô‡∂± ‡∑Ä‡∑í‡∂Ø‡∑í‡∑Ñ ‡∂î‡∑Ñ‡∑î‡∂ß ‡∂Ø‡∑ê‡∂´‡∑î‡∂±‡∑è. ‡∂á‡∂ú‡∑ö ‡∂Ö‡∂≠ ‡∑É‡∑í‡∂±‡∑í‡∂≥‡∑î ‡∑Ä‡∑î‡∂´‡∑è ‡∑Ä‡∂ú‡∑ö ‡∂∏ ‡∂ã‡∂´‡∑î‡∑É‡∑î‡∂∏‡∑ä ‡∑Ä‡∑î‡∂´‡∑è. ‡∂í‡∂ö ‡∂î‡∑Ñ‡∑î‡∂ß ‡∂á‡∂≠‡∑í ‡∂ö‡∂ª‡∑ö ‡∂ú‡∑î‡∂Ω‡∑í‡∑Ä‡∑ô‡∂Ω‡∑è ‡∂±‡∑í‡∂Ø‡∑è‡∂ú‡∑ê‡∂±‡∑ì‡∂∏‡∑ö ‡∑Ä‡∑î‡∑Ä‡∂∏‡∂±‡∑è‡∑Ä‡∂ö‡∑ä. ‡∂∏‡∑ñ‡∂ß ‡∂∏‡∑ö ‡∂∏‡∑ú‡∂ö‡∂ö‡∑ä ‡∂Ø ‡∑Ä‡∑î‡∂´‡∑ö ‡∑Ä‡∂ú‡∑ö ‡∂Ω‡∑î‡∂ö‡∑ä ‡∂ë‡∂ö‡∂ö‡∑ä ‡∂ë‡∂ö‡∑ä‡∂ö ‡∂á‡∂∫ ‡∂î‡∑Ñ‡∑î ‡∂Ø‡∑í‡∑Ñ‡∑è‡∑Ä‡∂ß ‡∑Ñ‡∑ê‡∂ª‡∑î‡∂´‡∑è. ‡∂∏‡∑î‡∂ö‡∑î‡∂≠‡∑ä ‡∂±‡∑ú‡∂ö‡∑í‡∂∫ ‡∂∏ ‡∂î‡∑Ñ‡∑î‡∂≠‡∑ä ‡∂á‡∂∫ ‡∂Ø‡∑í‡∑Ñ‡∑è ‡∂∂‡∂Ω‡∑è‡∂ú‡∑ô‡∂± ‡∂â‡∂≥‡∂Ω‡∑è ‡∂≠‡∑í‡∂∂‡∑î‡∂´‡∑è. ‡∂≠‡∂≠‡∑ä‡∂¥‡∂ª ‡∂Ø‡∑Ñ‡∂∫‡∂ö‡∑ä ‡∑Ä‡∑í‡∂≠‡∂ª ‡∂î‡∑Ä‡∑î‡∂±‡∑ä ‡∂ë‡∂ö‡∑í‡∂±‡∑ô‡∂ö‡∑è ‡∂Ø‡∑í‡∑Ñ‡∑è ‡∂∂‡∂Ω‡∑è‡∂ú‡∑ô‡∂± ‡∂â‡∂Ø‡∑ä‡∂Ø‡∑í, ‡∂î‡∑Ñ‡∑î‡∂ß ‡∂á‡∂≠‡∑ä‡∂≠‡∂ß ‡∂∏ ‡∑Ñ‡∑ê‡∂∏‡∂Ø‡∑ö‡∂∏ ‡∑Ñ‡∑ú‡∂≥‡∑í‡∂±‡∑ä ‡∑É‡∑í‡∂Ø‡∑ä‡∂∞‡∑Ä‡∑ô‡∂∫‡∑í ‡∂ö‡∑í‡∂∫‡∂Ω‡∑è ‡∂Ø‡∑ê‡∂±‡∑ô‡∂±‡∑ä‡∂± ‡∂¥‡∂ß‡∂Ç ‡∂ú‡∂≠‡∑ä‡∂≠‡∑è. ‡∂í ‡∑Ä‡∂ú‡∑ö ‡∂∏ ‡∑Ñ‡∑ê‡∂∏‡∂Ø‡∑ö‡∂∏ ‡∑Ñ‡∑ú‡∂≥‡∑í‡∂±‡∑ä ‡∑É‡∑í‡∂Ø‡∑ä‡∂∞ ‡∑Ä‡∑ö‡∑Ä‡∑í ‡∂ö‡∑í‡∂∫‡∂Ω‡∑è ‡∂î‡∑Ñ‡∑î ‡∑Ä‡∑í‡∑Å‡∑ä‡∑Ä‡∑è‡∑É ‡∂ö‡∂ª‡∂±‡∑ä‡∂± ‡∂¥‡∂ß‡∂Ç ‡∂Ö‡∂ª‡∂ú‡∑ô‡∂± ‡∂≠‡∑í‡∂∂‡∑î‡∂´‡∑è. ‡∂í‡∂≠‡∑ä ‡∂ë‡∂ö‡∑ä‡∂ö ‡∂∏ ‡∂ö‡∂≥‡∑Ä‡∑î‡∂ª‡∑ö ‡∂ö‡∑ô‡∑Ö‡∑Ä‡∂ª‡∂ö‡∑í‡∂±‡∑ä ‡∂ö‡∑Ä‡∑î‡∂Ø‡∑ù ‡∂ö‡∑ë‡∂ú‡∑Ñ‡∂±‡∑Ä‡∑è ‡∂á‡∑Ñ‡∑î‡∂´‡∑è. ‚Äú‡∑É‡∑í‡∂ª‡∑í‡∂∏‡∂Ω‡∑ä ‡∂Ö‡∂∫‡∑í‡∂∫‡∑è ‡∑Ä‡∑ê‡∂ß‡∑í‡∂Ω‡∑è‚Ä¶‚Äù",
                image: "https://katha.lk/wp-content/uploads/2025/06/S0526-E-Dawas-Hari-Wenas-Abdul-Umar-Sahan-Nethmina.webp",
                available: true,
                status: "" // new arrival: new, Leaving soon: leaving, or null
            },

            {
                id: 4,
                title: "‡∂Ö‡∂∂‡∑ä‡∂Ø‡∑î‡∂Ω‡∑ä ‡∑Ä‡∑ô‡∂±‡∑ä‡∂± ‡∂ö‡∂Ω‡∑í‡∂±‡∑ä | Abdul Wenna Kalin",
                author: "Abdul Umar Sahan Nethmina",
                genre: "Poetry",
                year: "Unknown",
                rating: 4.9,
                category: "Teens",
                pages: 80,
                location: "MLC/P/00004/TN",
                description: "‡∂Ö‡∂¥‡∑í‡∂ß ‡∂¥‡∑É‡∑ä‡∑É‡∑ô‡∂±‡∑ä ‡∂¥‡∑í‡∂∫‡∑è‡∂π‡∂± ‡∂ã‡∂Ç ‡∂Ü‡∂∫‡∑ô ‡∑Ñ‡∑í‡∂ª‡∑Ä‡∑í‡∂∫ ‡∂∫‡∑î‡∂≠‡∑î‡∂Ø ‡∂ö‡∑ú‡∂ß‡∑î‡∑Ä‡∂Ω ‡∂≠‡∂ß‡∑î ‡∂ö‡∂¥‡∂¥‡∑î ‡∂Ø‡∑î‡∂ö ‡∂Ö‡∂¥‡∑í ‡∑Ä‡∂ú‡∑ö ‡∂ã‡∂Ç ‡∂Ü‡∂∫‡∑ô‡∂∏‡∂≠‡∑ä ‡∂Ω‡∑í‡∂∫ ‡∂∫‡∑î‡∂≠‡∑î‡∂Ø ‡∂¥‡∑í‡∂ß‡∑î‡∑Ä‡∂Ω ‡∂ú‡∑ú‡∂ª‡∑Ä ‡∂ú‡∑ú‡∂ª‡∑Ä‡∑è ‡∂∂‡∂Ω‡∂Ç ‡∂â‡∂±‡∑ä‡∂±‡∑Ä‡∑è ‡∂≠‡∂∏‡∂∫‡∑í ‡∑Ä‡∂ß‡∑ö‡∂∏ ‡∂Ö‡∂≥‡∑î‡∂ª‡∑î ‡∂ö‡∂ª‡∑î‡∑Ä‡∂Ω ‡∂ë‡∑Ñ‡∑ô‡∑Ä‡∑ä ‡∑Ä‡∑í‡∂ß‡∂ö‡∂Ø‡∑í ‡∂ú‡∑í‡∂±‡∑ä‡∂Ø‡∂ª‡∂ö‡∑ä ‡∂∏‡∑í‡∑É ‡∂ë‡∂Ω‡∑í‡∂∫ ‡∂∏‡∂Ø‡∑í ‡∂Ø‡∑î‡∂ª ‡∂à‡∂≠ ‡∂≠‡∂ª‡∑î‡∑Ä‡∂Ω",
                image: "https://katha.lk/wp-content/uploads/2025/11/S0575-Abdul-Wnna-Kalin-Abdul-Umar-Sahan-Nethmina.webp",
                available: true,
                status: "" // new arrival: new, Leaving soon: leaving, or null
            },

            {
                id: 5,
                title: "‡∂Ü‡∂ö‡∑í‡∂∏‡∑í‡∂©‡∑í‡∑É‡∑ä ‡∑É‡∑í‡∂∫ ‡∂Ø‡∑í‡∑Ä‡∑í ‡∂±‡∑É‡∑è ‡∂ú‡∂±‡∑ì | Akimidis Siya Diwi Nasa Gani",
                author: "Ruuso",
                genre: "Poetry",
                year: "2022 NOV",
                rating: 7.0,
                category: "Teens",
                pages: 80,
                location: "MLC/P/00005/TN",
                description: "‡∂ë‡∂ö‡∂¥‡∑è‡∂ª‡∂∏ ‡∂∏‡∑Ñ ‡∑Ñ‡∂∫‡∑í‡∂∫‡∑ô‡∂±‡∑ä ‡∑Ä‡∑Ñ‡∑í‡∂±‡∑ä‡∂± ‡∂ú‡∂≠‡∑ä‡∂≠‡∑è ‡∂ö‡∂ª‡∂Ø‡∂ª‡∂∫‡∑í ‡∂±‡∂∏‡∑ä ‡∂≠‡∂∏‡∂∫‡∑í ‡∂í‡∂≠‡∑ä ‡∂∏‡∂Ç ‡∑Ä‡∑Ñ‡∂Ω‡∑ô ‡∂≠‡∑ô‡∂∏‡∑ô‡∂± ‡∂≠‡∑ê‡∂±‡∑ä ‡∂Ø‡∑ê‡∂±‡∂ú‡∂≠‡∑ä‡∂≠‡∑è",
                image: "https://rasakatha.lk/wp-content/uploads/2024/09/WhatsApp-Image-2024-09-15-at-8.03.23-AM-548x800.jpeg",
                available: true,
                status: "" // new arrival: new, Leaving soon: leaving, or null
            },

            {
                id: 6,
                title: "‡∂Ö‡∂∏‡∑ä‡∂∏‡∂¥‡∂∫‡∑í ‡∂∏‡∂Ç ‡∂ö‡∂©‡∑î‡∑Ä ‡∂Ø‡∑î‡∂±‡∑ä‡∂±‡∑è | Ammapayi Man Kaduwa Dunna",
                author: "Shashika Sadeep",
                genre: "Poetry",
                year: "Unknown",
                rating: 7.2,
                category: "Teens",
                pages: 86,
                location: "MLC/P/00006/TN",
                description: "‡∑É‡∑ê‡∂© ‡∑É‡∑î‡∑Ö‡∂ü ‡∂Ø‡∂ª‡∂±‡∑ä‡∂±‡∂ß ‡∂±‡∑ú‡∑Ñ‡∑ê‡∂ö‡∑í ‡∂≠‡∑ê‡∂± ‡∂ª‡∑î‡∑Ä‡∂Ω‡∂ß ‡∂∏‡∂ú ‡∂ö‡∑í‡∂∫‡∂¥‡∑î ‡∂≠‡∂ª‡∑î ‡∂ö‡∑ê‡∂ß‡∂≠‡∑ä ‡∂¥‡∑ê‡∂± ‡∂ú‡∑í‡∂∫‡∂¥‡∑î ‡∂ª‡∑ê‡∂∫‡∂ö‡∂ß ‡∑É‡∂∫‡∑î‡∂ª ‡∂∏‡∑ê‡∂Ø ‡∂∏‡∑è‡∂Ω‡∑í‡∂ú‡∑è ‡∂ö‡∂ß‡∑î ‡∂ö‡∑ê‡∂©‡∑î‡∂´‡∑î ‡∂±‡∑ê‡∑Ä‡∂ö‡∂ß ‡∂¥‡∑ä‚Äç‡∂ª‡∑ö‡∂∏‡∂∫‡∂ö‡∑í, ‡∂¥‡∑ä‚Äç‡∂ª‡∂Ø‡∑ì‡∂¥‡∑è‡∂ú‡∑è‡∂ª‡∂∫‡∂ö ‡∂ë‡∑Ö‡∑í ‡∑Ä‡∑ê‡∂ß",
                image: "https://rasakatha.lk/wp-content/uploads/2024/01/69-1.jpg",
                available: false,
                status: "" // new arrival: new, Leaving soon: leaving, or null
            },

            {
                id: 7,
                title: "‡∂ö‡∑ê‡∂∏‡∑ô‡∂Ω‡∑í‡∂∫‡∑è | Camellia",
                author: "Virajini Thennakoo",
                genre: "Novel",
                year: "Unknown",
                rating: 5.8,
                category: "Teens",
                pages: 222,
                location: "MLC/N/00007/TN",
                description: "‚Äú‡∂∂‡∂Ω‡∑ä‡∂Ω‡∑ú ‡∂∏‡∑í‡∂±‡∑í‡∑É‡∑ä‡∑É‡∑î ‡∑Ä‡∂ú‡∑ö ‡∂ö‡∂≠‡∑è ‡∂ö‡∂ª‡∂±‡∑ä‡∂± ‡∂¥‡∑î‡∂ª‡∑î‡∂Ø‡∑î ‡∑Ä‡∑î‡∂´‡∑è ‡∂±‡∂∏‡∑ä ‡∂ã‡∂±‡∑ä ‡∂î‡∂†‡∑ä‡∂†‡∂ª ‡∑Ñ‡∑ú‡∂≥ ‡∑Ä‡∑ô‡∂±‡∑ä‡∂±‡∑ô ‡∂±‡∑ë ‡∂ö‡∑í‡∂∫‡∂Ω‡∂≠‡∑ä ‡∂∏‡∂≠‡∂ö ‡∂≠‡∑í‡∂∫‡∑è‡∂ú‡∂±‡∑ä‡∂±. ‡∂ë‡∑Ñ‡∑ô‡∂±‡∂Ç ‡∂ã‡∂±‡∑ä ‡∂î‡∂∫‡∑è‡∑Ä ‡∑Ñ‡∂¥‡∑è ‡∂ö‡∂±‡∑ä‡∂±‡∑ô ‡∑Ä‡∂Ω‡∑í‡∂ú‡∑ô ‡∑Ä‡∂±‡∂Ω‡∑è‚Äù -‡∂á‡∂±‡∑í‡∂ß‡∑è",
                image: "https://katha.lk/wp-content/uploads/2024/06/s0300-camellia-virajini-thennakoon.webp",
                available: false,
                status: "" // new arrival: new, Leaving soon: leaving, or null
            },

            {
                id: 8,
                title: "‡∂ª‡∑ù‡∂¢‡∑è | Roja",
                author: "Niluka Brandon",
                genre: "Romance",
                year: "Unknown",
                rating: 4.2,
                category: "YA",
                pages: 392,
                location: "MLC/R/00008/YA",
                description: "‡∂∏‡∑í‡∂±‡∑í‡∑É‡∑ä‡∑É‡∑î‚Ä¶ ‡∂Ø‡∑î‡∂∂‡∂Ω‡∂∫‡∂±‡∑ä‡∑Ä ‡∂â‡∂¥‡∂Ø‡∑ô‡∂±‡∑ä‡∂±‡∑è‡∑Ñ. ‡∂∏‡∑í‡∂±‡∑í‡∑É‡∑ä‡∑É‡∑î‚Ä¶ ‡∂¢‡∑ì‡∑Ä‡∑í‡∂≠‡∂∫‡∑ö ‡∂∫‡∂∏‡∑ä ‡∂∫‡∂∏‡∑ä ‡∂∫‡∑î‡∂ú‡∑Ä‡∂Ω ‡∑Ä‡∑í‡∑Ä‡∑í‡∂∞ ‡∑Ñ‡∑ö‡∂≠‡∑î ‡∂ö‡∑è‡∂ª‡∂´‡∑è‡∑Ä‡∂±‡∑ä ‡∂±‡∑í‡∑É‡∑è‡∑Ä‡∑ô‡∂±‡∑ä ‡∂Ø‡∑î‡∂∂‡∂Ω‡∂∫‡∂±‡∑ä‡∑Ä ‡∂¢‡∑ì‡∑Ä‡∑í‡∂≠‡∂∫ ‡∂ª‡∑ê‡∂ö‡∂ú‡∂±‡∑ä‡∂±‡∑è‡∑Ñ. ‡∂±‡∂∏‡∑î‡∂≠‡∑ä‚Ä¶ ‡∂Ö‡∂¥ ‡∂ö‡∑í‡∑É‡∑í‡∑Ä‡∑ô‡∂ö‡∑î‡∂ß‡∂≠‡∑ä ‡∂Ø‡∑î‡∂∂‡∂Ω‡∂∫‡∂±‡∑ä‡∑Ä ‡∂∏‡∑í‡∂∫ ‡∂∫‡∂±‡∑ä‡∂±‡∂ß ‡∂Ö‡∂∫‡∑í‡∂≠‡∑í‡∂∫‡∂ö‡∑ä ‡∂±‡∑ê‡∂≠. ‡∂Ö‡∂¥‡∑í ‡∂±‡∑ê‡∂ü‡∑í‡∂ß‡∑í‡∂∫ ‡∂∫‡∑î‡∂≠‡∑î‡∂∫! ‡∂Ö‡∂¥‡∑í ‡∑Ñ‡∑í‡∂±‡∑ê‡∑Ñ‡∑í‡∂∫ ‡∂∫‡∑î‡∂≠‡∑î‡∂∏‡∂∫!",
                image: "https://katha.lk/wp-content/uploads/2024/06/s0296-roja-niluka-brandon.webp",
                available: false,
                status: "" // new arrival: new, Leaving soon: leaving, or null
            },

            {
                id: 9,
                title: "‡∂á‡∂≠‡∑ä‡∂≠ ‡∂ö‡∑í‡∂∫‡∂¥‡∂±‡∑ä ‡∂ö‡∑ä‡∂Ω‡∑í‡∂∫‡∑ù‡∂¥‡∑ê‡∂ß‡∑ä‚Äç‡∂ª‡∑è | Atta Kiyapan Cleopatra",
                author: "Bebadu Kumara",
                genre: "Poetry",
                year: "Unknown",
                rating: 8.6,
                category: "Teens",
                pages: "error 101",
                location: "MLC/P/00009/TN",
                description: "‡∂¥‡∑ä‚Äç‡∂ª‡∑ö‡∂∏‡∂∫‡∑ö ‡∂â‡∂ª‡∑í‡∂≠‡∑ê‡∑Ö‡∑î‡∂∏‡∑ä ‡∑Ä‡∂Ω‡∂ß ‡∑É‡∑ú‡∂∫‡∑è‡∂ú‡∑ô‡∂± ‡∂±‡∑ë ‡∑É‡∑ê‡∂≠‡∑ä‡∂ö‡∂∏‡∑ä ‡∂±‡∂∏‡∑î‡∂Ø‡∑î ‡∑É‡∂Ø‡∑Ñ‡∂ß ‡∂±‡∑î‡∂π‡∑ö ‡∂±‡∂∏‡∂ß‡∂∫‡∑í ‡∂∏‡∑ö ‡∂¥‡∂¥‡∑î‡∑Ä‡∑ö ‡∑Ä‡∂≠‡∑ä‡∂ö‡∂∏‡∑ä ‡∂ö‡∑è‡∂Ω‡∂∫‡∑è ‡∑Ä‡∑í‡∑É‡∑í‡∂±‡∑ä ‡∑Ä‡∑í‡∑É‡∂≥‡∑è‡∑Ä‡∑í ‡∂ª‡∑í‡∂Ø‡∑î‡∂∏‡∑ä ‡∂Ø‡∑ô‡∂± ‡∑É‡∂Ç‡∑É‡∑è‡∂ª ‡∂ú‡∑ô‡∂≠‡∑ä‡∂≠‡∂∏‡∑ä ‡∂∏‡∂∏ ‡∂∏‡∂ö‡∑ä‡∂ö‡∂ª‡∂±‡∑ä‡∂±‡∂Ø ‡∂Ö‡∂¥‡∑í‡∂ß ‡∂Ö‡∂¥‡∑í ‡∑Ñ‡∑í‡∂∏‡∑í ‡∂±‡∑ê‡∂≠‡∑ä‡∂±‡∂∏‡∑ä... ‡∑Ñ‡∑í‡∂±‡∑è‡∑Ä ‡∂≠‡∑í‡∂∫‡∑ô‡∂± ‡∂Ø‡∑î‡∂ª‡∂ö‡∂ß ‡∂î‡∂∫‡∑è ‡∂Ø‡∑î‡∑Ä‡∂ú‡∑ô‡∂± ‡∂∫‡∂±‡∑ä‡∂± ‡∂∏‡∂∏ ‡∂∂‡∂Ω‡∑è‡∂ú‡∑ô‡∂± ‡∂â‡∂±‡∑ä‡∂±‡∂∏‡∑ä",
                image: "https://rasakatha.lk/wp-content/uploads/2024/07/WhatsApp-Image-2024-07-28-at-7.12.56-PM.jpeg",
                available: true,
                status: "" // new arrival: new, Leaving soon: leaving, or null
            },

            {
                id: 10,
                title: "‡∂¥‡∑ä‚Äç‡∂ª‡∂∂‡∂±‡∑ä‡∂∞ ‡∑É‡∂∏‡∑ä‡∂∂‡∂±‡∑ä‡∂∞ | Fiction Affairs",
                author: "Sri Jayathilaka",
                genre: "Novel",
                year: "Unknown",
                rating: 7.6,
                category: "YA",
                pages: "error 101",
                location: "MLC/N/00010/YA",
                description: "Sorry, No description available.",
                image: "https://rasakatha.lk/wp-content/uploads/2025/05/WhatsApp-Image-2025-05-28-at-9.49.13-PM-430x687.jpeg",
                available: false,
                status: "" // new arrival: new, Leaving soon: leaving, or null
            },

            {
                id: 11,
                title: "London",
                author: "Edward Rutherfurd",
                genre: "Novel",
                year: "1997 JAN",
                rating: 8.9,
                category: "YA",
                pages: 1332,
                location: "MLC/N-E/00011/YA",
                description: "Here is Edward Rutherfurd‚Äôs classic novel of London, a glorious pageant spanning two thousand years. He brings this vibrant city‚Äôs long and noble history alive through the ever-shifting fortunes, fates, and intrigues of half-a-dozen families, from the age of Julius Caesar to the twentieth century. Generation after generation, these families embody the passion, struggle, wealth, and verve of the greatest city in the Old World",
                image: "https://m.media-amazon.com/images/S/compressed.photo.goodreads.com/books/1328313657i/12407442.jpg",
                available: false,
                status: "" // new arrival: new, Leaving soon: leaving, or null
            },

            {
                id: 12,
                title: "Forget Me Not | ‡∑Ü‡∑ú‡∂ú‡∑ô‡∂ß‡∑ä ‡∂∏‡∑ì ‡∂±‡∑ú‡∂ß‡∑ä",
                author: "Charitha Prawardhi Bandara | Chathuri Damayanthi",
                genre: "Novel",
                year: "Unknown",
                rating: 6.8,
                category: "Teens",
                pages: 226,
                location: "MLC/N/00012/TN",
                description: "‡∂∂‡∑í‡∂≥‡∑î‡∂´‡∑î ‡∂∏‡∑í‡∂±‡∑í‡∑É‡∑ä‡∑É‡∑î‡∂±‡∑ä‡∂ß ‡∂Ü‡∂Ø‡∂ª‡∂∫ ‡∂ö‡∂ª‡∂± ‡∂ë‡∂ö ‡∂ö‡∑ú‡∑Ñ‡∑ô‡∂≠‡∑ä‡∂∏ ‡∂Ω‡∑ö‡∑É‡∑í ‡∂±‡∑ë ‡∂∫‡∑î‡∂∏‡∑ì ‡∑É‡∂Ç ‡∂ö‡∑ê‡∂∂‡∂Ω‡∑í ‡∑Ä‡∑ô‡∂†‡∑ä‡∂†‡∑í ‡∂î‡∑Ä‡∑î‡∂±‡∑ä‡∑Ä ‡∂≠‡∂Ø‡∑í‡∂±‡∑ä ‡∑Ä‡∑ê‡∑Ö‡∂≥‡∂ú‡∂≠ ‡∂∫‡∑î‡∂≠‡∑î ‡∑Ä‡∑ô‡∂±‡∑Ä‡∑è ‡∂∏‡∑î‡∂Ø‡∑î ‡∂±‡∂∏‡∑î‡∂≠‡∑ä ‡∑É‡∑ä‡∂Æ‡∑ì‡∂ª ‡∂¥‡∑ä‚Äç‡∂ª‡∑ö‡∂∏‡∂∫‡∂ö‡∑í‡∂±‡∑ä. ‡∂í‡∂≠‡∑ä ‡∂í ‡∂≠‡∑í‡∂∫‡∑î‡∂´‡∑î ‡∂Ø‡∑è‡∂ª ‡∑É‡∑Ñ‡∑í‡∂≠ ‡∂∂‡∑í‡∂≥‡∑î‡∂´‡∑î ‡∂ö‡∑ê‡∂∂‡∂Ω‡∑í, ‡∑Ä‡∑ê‡∑Ö‡∂Ø‡∂ú‡∂±‡∑ä‡∂±‡∑è ‡∂Ü‡∂Ø‡∂ª‡∂´‡∑ì‡∂∫‡∂∫‡∑è‡∑Ä ‡∂ª‡∑í‡∂Ø‡∑Ä‡∂±‡∑Ä‡∑è. ‡∂î‡∑Ñ‡∑î‡∑Ä‡∂≠‡∑ä ‡∂ö‡∂¥‡∑è ‡∂Ø‡∂∏‡∂±‡∑Ä‡∑è. ‡∂∏‡∂ß ‡∑Ñ‡∑ú‡∂≥‡∂ß‡∂∏ ‡∑Ä‡∑í‡∑Å‡∑ä‡∑Ä‡∑è‡∑É‡∂∫‡∑í, ‡∂Ü‡∂Ø‡∂ª‡∂∫ ‡∂ö‡∑í‡∂∫‡∂±‡∑ä‡∂±‡∑ö ‡∂ö‡∑ê‡∂¥‡∂ö‡∑í‡∂ª‡∑ì‡∂∏‡∂ö‡∑ä‚Äù ‡∑Ä‡∂ú ‡∂ö‡∑í‡∂∫‡∂±‡∑ä‡∂±‡∂ß ‡∂á‡∂≠‡∑ä‡∂≠‡∑ö, ‡∂∏‡∑ö ‡∂Ω‡∑ù‡∂ö‡∂∫‡∑ö ‡∂∏‡∑î‡∂Ω‡∑ä ‡∑Ä‡∂≠‡∑è‡∑Ä‡∂ß ‡∂∂‡∑í‡∂≥‡∑î‡∂´‡∑î ‡∂ú‡∑ê‡∑Ñ‡∑ê‡∂´‡∑í‡∂∫‡∂ö‡∂ß ‡∂Ü‡∂Ø‡∂ª‡∂∫ ‡∂ö‡∂ª‡∂¥‡∑î ‡∂ö‡∂ª‡∑î‡∂´‡∑è‡∑Ä‡∂±‡∑ä‡∂≠ ‡∂á‡∑Ñ‡∑í‡∂¥‡∑í‡∂∫ ‡∂á‡∂≠‡∑í ‡∂¥‡∑í‡∂ª‡∑í‡∂∏‡∑í‡∂∫‡∑ô‡∂ö‡∑ä. ‡∂ö‡∑ê‡∂∂‡∂Ω‡∑í ‡∑Ä‡∑î‡∂´‡∑î ‡∂¥‡∑í‡∂ª‡∑í‡∂∏‡∑í‡∂∫‡∑ô‡∂ö‡∑î‡∂ß ‡∂¥‡∑ä‚Äç‡∂ª‡∑ö‡∂∏ ‡∂ö‡∑Ö ‡∑Ä‡∑í‡∑Å‡∑è‡∂Ω ‡∑Ñ‡∂Ø‡∑Ä‡∂≠‡∂ö‡∑ä ‡∂á‡∂≠‡∑í ‡∂ú‡∑Ñ‡∑ê‡∂´‡∑í‡∂∫‡∂ö‡∑ä.",
                image: "https://katha.lk/wp-content/uploads/2024/05/s0185-forget-me-not-charitha-prawardhi-bandara-chathuri-damayanthi.webp",
                available: true,
                status: "" // new arrival: new, Leaving soon: leaving, or null
            },

            {
                id: 13,
                title: "‡∂á‡∑Ñ‡∑ê‡∑Ö ‡∂∏‡∂Ω‡∂ß ‡∂Ø‡∂∏‡∑ä ‡∂¥‡∑è‡∂ß‡∂ö‡∑ä | Ehela Malata Dam Patak",
                author: "Chathuri Damayanthi",
                genre: "Novel",
                year: "Unknown",
                rating: 7.5,
                category: "YA",
                pages: 290,
                location: "MLC/N/00013/YA",
                description: "Working on it.",
                image: "https://katha.lk/wp-content/uploads/2024/05/s0186-ehala-malata-dam-patak-chathuri-damayanthi.webp",
                available: false,
                status: "" // new arrival: new, Leaving soon: leaving, or null
            },

            {
                id: 14,
                title: "‡∂Ø‡∑Ä‡∑É‡∂ö‡∑ä ‡∂Ø‡∑è ‡∑Ñ‡∑ê‡∂±‡∑ä‡∂Ø‡∑ë‡∑Ä‡∂ö | Dawasak Da Handawaka",
                author: "Rasika Jayakody",
                genre: "Miscellaneous",
                year: "Unknown",
                rating: 6.0,
                category: "YA",
                pages: 120,
                location: "MLC/M/00014/YA",
                description: "‡∂¢‡∑ì‡∑Ä‡∑í‡∂≠‡∂∫‡∑ö ‡∂ö‡∑ô‡∑Ö‡∑Ä‡∂ª‡∂ö‡∑ä ‡∂±‡∑ê‡∂≠‡∑í ‡∂∏‡∑í‡∂±‡∑í‡∑É‡∑ä ‡∑É‡∂∂‡∂≥‡∂≠‡∑è‡∑Ä‡∂Ω‡∂ß‡∂≠‡∑ä ‡∂∏‡∑ö ‚Äò‡∂±‡∑ä‚Äç‡∂∫‡∑è‡∂∫‚Äô ‡∂∏ ‡∂ú‡∑Ö‡∂¥‡∂±‡∑ä‡∂±‡∂ß ‡∂¥‡∑î‡∑Ö‡∑î‡∑Ä‡∂±‡∑ä. ‡∂ö‡∂≠‡∑è‡∂∂‡∑Ñ ‡∂ö‡∑í‡∂ª‡∑ì‡∂∏ ‡∑É‡∑Ñ ‡∂ö‡∂≠‡∑è ‡∂±‡∑ú‡∂ö‡∂ª ‡∑É‡∑í‡∂ß‡∑ì‡∂∏, ‡∑Ñ‡∂∏‡∑î‡∑Ä‡∑ì‡∂∏ ‡∑É‡∑Ñ ‡∑Ñ‡∂∏‡∑î ‡∂±‡∑ú‡∑Ä‡∑ì ‡∑É‡∑í‡∂ß‡∑ì‡∂∏, ‡∑Ö‡∂Ç ‡∑Ä‡∑ì‡∂∏ ‡∑É‡∑Ñ ‡∂Ø‡∑î‡∂ª‡∑É‡∑ä‡∑Ä ‡∑É‡∑í‡∂ß‡∑ì‡∂∏, ‡∂¥‡∑ê‡∂∏‡∑í‡∂´‡∑ì‡∂∏ ‡∑É‡∑Ñ ‡∂±‡∑ú‡∂¥‡∑ê‡∂∏‡∑í‡∂´‡∑ì‡∂∏‚Ä¶‡∂∏‡∑ö ‡∑É‡∑í‡∂∫‡∂Ω‡∑ä‡∂Ω‡∂ö‡∑ä ‡∂∏ ‡∂¢‡∑ì‡∑Ä‡∂≠‡∑ä ‡∑Ä‡∑ì‡∂∏ ‡∑É‡∂≥‡∑Ñ‡∑è ‡∂Ö‡∑Ä‡∑Å‡∑ä‚Äç‡∂∫‡∂∫‡∑í. ‡∂∏‡∑ö ‡∑É‡∑í‡∂∫‡∂Ω‡∑î‡∂∏ ‡∑É‡∂Ç‡∑É‡∑í‡∂Ø‡∑ä‡∂∞‡∑ì‡∂±‡∑ä ‡∂ë‡∂ö‡∂ö‡∂ß ‡∂ë‡∂ö‡∂ö‡∑ä ‡∑Ä‡∑ô‡∂±‡∑ä ‡∂ö‡∑Ö ‡∂±‡∑ú‡∑Ñ‡∑ê‡∂ö‡∑í ‡∑É‡∑ö ‡∑É‡∑Ñ ‡∑É‡∂∏‡∑ä‡∂∂‡∂±‡∑ä‡∂∞‡∂∫‡∑í. ‡∑É‡∂Ç‡∂ú‡∑ì‡∂≠ ‡∑É‡∂Ç‡∂∞‡∑ä‡∑Ä‡∂±‡∑í‡∂∫‡∂ö ‡∑É‡∑ä‡∑Ä‡∂ª ‡∑É‡∑Ñ ‡∂±‡∑í‡∑Ñ‡∑ê‡∂¨‡∑í‡∂∫‡∑è‡∑Ä ‡∑Ä‡∂ú‡∑ö‚Ä¶ ‡∂ö‡∑Ä‡∑í‡∂∫‡∂ö ‡∂ö‡∑í‡∂∫‡∑ê‡∑Ä‡∑ô‡∂± ‡∂Ø‡∑ö ‡∑É‡∑Ñ ‡∂±‡∑ú ‡∂ö‡∑í‡∂∫‡∑ê‡∑Ä‡∑ô‡∂± ‡∂Ø‡∑ö ‡∑Ä‡∂ú‡∑ö. ‡∂∏‡∑è ‡∂¢‡∑ì‡∑Ä‡∑í‡∂≠‡∂∫ ‡∂ö‡∑í‡∂∫‡∑Ä‡∂± ‡∑Ä‡∑í‡∂Ø‡∑í‡∂∫‡∂ß ‚Äò‡∂ã‡∂¥‡∑ö‡∂ö‡∑ä‡∑Ç‡∑è‡∑Ä‚Äô ‡∂∫‡∂±‡∑î ‡∂∏‡∑ö ‡∑É‡∑Ñ ‡∑É‡∂∏‡∑ä‡∂∂‡∂±‡∑ä‡∂∞‡∂∫ ‡∂≠‡∑ö‡∂ª‡∑î‡∂∏‡∑ä ‡∂ú‡∑ê‡∂±‡∑ì‡∂∏‡∂∫‡∑í. ‡∂ã‡∂¥‡∑ö‡∂ö‡∑ä‡∑Ç‡∑è‡∑Ä ‡∂ë‡∂ö‡∑ä‡∂≠‡∂ª‡∑è ‡∑Ä‡∑í‡∂Ø‡∑í‡∂∫‡∂ö ‡∑É‡∑î‡∑Ä‡∂∂‡∂ª ‡∂±‡∑í‡∂Ø‡∑ä‚Äç‡∂ª‡∑è‡∑Ä‡∂ö‡∑ä.",
                image: "https://katha.lk/wp-content/uploads/2024/07/s0449-dawasak-da-handawaka-rasika-jayakody.webp",
                available: false,
                status: "" // new arrival: new, Leaving soon: leaving, or null
            },

            {
                id: 15,
                title: "If It's Not Forever",
                author: "Durjoy Datta | Nikita Singh",
                genre: "Romance",
                year: "2012",
                rating: 6.0,
                category: "Adult",
                pages: 239,
                location: "MLC/M/00015/A",
                description: "If It's Not Forever is a novel by Durjoy Datta and Nikita Singh.[1] It was published in the year 2012 by Grapevine India Publishers. It is set on the story of the 2011 Delhi High Court blasts.[2][3] Though mentioned as a love story, it is more of a suspense thriller. There are seven characters mentioned in this book, with the main protagonist being Debashish (Deb), who hails from Bengal and is deeply scarred with haunting memories of the blast. The book has received average reviews from critics all over India.",
                image: "https://upload.wikimedia.org/wikipedia/en/2/2a/If_Its_Not_Forever.jpg",
                available: false,
                status: "" // new arrival: new, Leaving soon: leaving, or null
            },

            {
                id: 16,
                title: "‡∂∂‡∂∫‡∑ù ‡∂ö‡∂ª‡∂¥‡∑î ‡∂í‡∂Ω‡∑ô‡∑Ä‡∂Ω‡∑ä | Bio Karapu A Level",
                author: "Abdul Umar Sahan Nethmina",
                genre: "Poetry",
                year: "Unknown",
                rating: 5.4,
                category: "Teens",
                pages: 52,
                location: "MLC/P/00016/TN",
                description: "‡∂∏‡∂ß ‡∂ï‡∂±‡∑ô ‡∂Ø‡∑ê‡∂Ç ‡∂î‡∂∫‡∑è ‡∂ë‡∂ö‡∑ä‡∂ö ‡∑É‡∑ä‡∂±‡∑è‡∂∫‡∑î‡∑Ä‡∂ö‡∑ä ‡∂Ø‡∑í‡∂ú‡∑ö ‡∂ú‡∂Ω‡∂± ‡∂Ü‡∑Ä‡∑ö‡∂ú‡∂∫‡∂ö‡∑ä ‡∑Ä‡∑ô‡∂±‡∑ä‡∂± ‡∂î‡∂∫‡∑è‡∂ß ‡∂â‡∑É‡∑ä‡∑É‡∑ô‡∂Ω‡∑ä‡∂Ω‡∑è‡∂∏ ‡∂Ø‡∑î‡∑Ä‡∂±‡∑ä‡∂± ‡∂Ø‡∑ì‡∂Ω‡∑è ‡∂Ö‡∂Ω‡∑ä‡∂Ω‡∂±‡∑ä‡∂± ‡∑Ä‡∂ú‡∑ö ‡∂Ø‡∑î‡∑Ä‡∂ú‡∑ô‡∂± ‡∂ë‡∂±‡∑ä‡∂± ‡∂Ö‡∂¥‡∑í‡∂ß ‡∂í ‡∂ú‡∂∏‡∂Ç ‡∂¥‡∑î‡∂Ω‡∑î‡∑Ä‡∂±‡∑ä ‡∂ö‡∂Ç‡∂ö‡∑è‡∂Ω ‡∂¥‡∑ö‡∑Ç‡∑í‡∂∫‡∂ö ‡∑É‡∑õ‡∂Ω ‡∑Ä‡∑ô‡∂±‡∑ä‡∂± ‡∂ö‡∑ú‡∂∫‡∑í‡∂≠‡∂ª‡∂∏‡∑ä ‡∂Ø‡∑ô‡∂¥‡∑ê‡∂≠‡∑ä‡∂≠‡∂ß ‡∂á‡∂Ø‡∑î‡∂´‡∂≠‡∑ä ‡∂©‡∑ô‡∑É‡∑ä‡∂∏‡∑É‡∑ù‡∂∏ ‡∂Ö‡∂Ω‡∑ä‡∂Ω‡∂Ç ‡∂â‡∂±‡∑ä‡∂± ‡∑Ä‡∑í‡∂Ø‡∑í‡∑Ñ ‡∂ú‡∑ê‡∂± ‡∂ö‡∑í‡∂∫‡∑Ä‡∂±‡∑ä‡∂± ‡∂Ö‡∂¥‡∑ö ‡∂Ü‡∂Ø‡∂ª‡∑ô‡∂≠‡∑ä ‡∂í ‡∑Ä‡∂ú‡∑ö ‡∂±‡∑ö‡∂Ø ‡∂ö‡∑í‡∂∫‡∂Ω‡∑è ‡∂ö‡∑ú‡∂≥‡∑î‡∂ª‡∂±‡∑ä‡∂± ‡∂â‡∂≠‡∑í‡∂Ç ‡∂â‡∂ö‡∑ä‡∂∏‡∂±‡∂ß ‡∂ö‡∑í‡∂∫‡∂±‡∑ä‡∂± ‡∂∏‡∂ß ‡∂î‡∂∫‡∑è ‡∂ë‡∂≠‡∑Ä‡∂Ø ‡∂±‡∑ê‡∂Ø‡∑ä‡∂Ø ‡∂∫‡∂±‡∑ä‡∂±",
                image: "https://katha.lk/wp-content/uploads/2024/04/s0153-bio-karapu-alevel-abdul-umar-sahan-nethmina.webp",
                available: true,
                status: "" // new arrival: new, Leaving soon: leaving, or null
            },

            {
                id: 17,
                title: "2001: A Space Odyssey",
                author: "Arthur C. Clarke",
                genre: "Sci-Fi",
                year: "1968 APR 28",
                rating: 9.4,
                category: "YA",
                pages: 297,
                location: "MLC/SFC/00017/YA",
                description: "On the Moon, an enigma is uncovered. So great are the implications of this discovery that for the first time men are sent out deep into our solar system.",
                image: "https://m.media-amazon.com/images/S/compressed.photo.goodreads.com/books/1432468943i/70535.jpg",
                available: true,
                status: "" // new arrival: new, Leaving soon: leaving, or null
            },

            {
                id: 18,
                title: "2010: Odyssey Two",
                author: "Arthur C. Clarke",
                genre: "Sci-Fi",
                year: "1982 DEC 01",
                rating: 8.7,
                category: "YA",
                pages: 320,
                location: "MLC/SFC/00018/YA",
                description: "When 2001: A Space Odyssey first shocked, amazed, and delighted millions in the late 1960s, the novel was quickly recognized as a classic. Since then, its fame has grown steadily among the multitudes who have read the novel or seen the film based on it. Yet, along with almost universal acclaim, a host of questions has grown more insistent through the years.",
                image: "https://m.media-amazon.com/images/S/compressed.photo.goodreads.com/books/1372677992i/18048525.jpg",
                available: true,
                status: "" // new arrival: new, Leaving soon: leaving, or null
            },

            {
                id: 19,
                title: "2061: Odyssey Three",
                author: "Arthur C. Clarke",
                genre: "Sci-Fi",
                year: "1987 DEC",
                rating: 8.6,
                category: "YA",
                pages: 266,
                location: "MLC/SFC/00019/YA",
                description: "The third book in Clarke‚Äôs beloved Space Odyssey continues the story of Heywood Floyd, survivor of two previous encounters with the mysterious monoliths and the alien intelligences behind them. Floyd is chosen as one of a handful of celebrity guests to witness the first manned touchdown on the surface of Halley‚Äôs Comet on the privately-owned spaceship Universe.",
                image: "https://m.media-amazon.com/images/S/compressed.photo.goodreads.com/books/1397988971i/18126623.jpg",
                available: true,
                status: "" // new arrival: new, Leaving soon: leaving, or null
            },

            {
                id: 20,
                title: "3001: The Final Odyssey",
                author: "Arthur C. Clarke",
                genre: "Sci-Fi",
                year: "1999 JAN 01",
                rating: 8.9,
                category: "YA",
                pages: 188,
                location: "MLC/SFC/00020/YA",
                description: "On an ill-fated mission to Jupiter in 2001, the mutinous supercomputer HAL sent crewmembers David Bowman and Frank Poole into the frozen void of space. Bowman‚Äôs strange transformation into a Star Child is traced through the novels 2010 and 2061. But now, a thousand years after his death, Frank Poole is brought back to life‚Äîand thrust into a world far more technically advanced than the one he left behind.",
                image: "https://m.media-amazon.com/images/S/compressed.photo.goodreads.com/books/1568155089l/53087570.jpg",
                available: true,
                status: "" // new arrival: new, Leaving soon: leaving, or null
            },

            {
                id: 21,
                title: "The Wolf's Curse",
                author: "Jessica Vitalis",
                genre: "Fiction",
                year: "2021 SEP 21",
                rating: 9.2,
                category: "YA",
                pages: 336,
                location: "MLC/FIC/00021/YA",
                description: "Twelve-year-old Gauge‚Äôs life has been cursed since the day he witnessed a Great White Wolf steal his grandpap√°‚Äôs soul, preventing it from reaching the Sea-in-the-Sky and sailing into eternity. When the superstitious residents of Bouge-by-the-Sea accuse the boy of crying wolf, he joins forces with another orphan to prove his innocence. They navigate their shared grief in a journey that ultimately reveals life-changing truths about the wolf‚Äì‚Äìand death.",
                image: "https://m.media-amazon.com/images/S/compressed.photo.goodreads.com/books/1611847802i/56382404.jpg",
                available: true,
                status: "" // new arrival: new, Leaving soon: leaving, or null
            },

            {
                id: 22,
                title: "New Dragon City: Eine verbotene Freundschaft",
                author: "Mari Mancusi",
                genre: "Fantasy",
                year: "2022 OCT 04",
                rating: 9.3,
                category: "YA",
                pages: 339,
                location: "MLC/F/00022/YA",
                description: "No one predicted the dragon apocalypse. The dragons came suddenly and decimated the world as we knew it, including New York City. Now, three years later, Noah, his hardcore survivalist father, and a ragtag group of survivors are barely scraping by in this new reality. Kids scavenge not only for materials in abandoned homes but also for leftover books at the library. Adults spend their time establishing a make-shift society and defending their shelter... with any means available. At least for the few months the dragons are hibernating, until it‚Äôs no longer safe aboveground.",
                image: "https://m.media-amazon.com/images/S/compressed.photo.goodreads.com/books/1706158553i/205902593.jpg",
                available: true,
                status: "" // new arrival: new, Leaving soon: leaving, or null
            },

            {
                id: 23,
                title: "Something Like Home",
                author: "Andrea Beatriz Arango",
                genre: "Poetry",
                year: "2023 SEP 12",
                rating: 9.3,
                category: "Teens",
                pages: 256,
                location: "MLC/P/00023/TN",
                description: "Laura Rodr√≠guez Col√≥n has a plan: no matter what the grown-ups say, she will live with her parents again. Can you blame her? It‚Äôs tough to make friends as the new kid at school. And while staying at her aunt‚Äôs house is okay, it just isn‚Äôt the same as being in her own space.",
                image: "https://m.media-amazon.com/images/S/compressed.photo.goodreads.com/books/1679081550i/70916843.jpg",
                available: true,
                status: "" // new arrival: new, Leaving soon: leaving, or null
            },

            {
                id: 24,
                title: "An Academic Affair",
                author: "Jodi McAlister",
                genre: "Romance",
                year: "2025 NOV 11",
                rating: 6.4,
                category: "Adult",
                pages: 366,
                location: "MLC/R/00024/A",
                description: "Sadie Shaw and Jonah Fisher have been academic rivals since they first crossed paths as undergraduates in the literature department thirteen years ago. Now that a highly coveted teaching opportunity has come up, their rivalry hits epic proportions. Jonah needs the job to move closer to his recently divorced sister and her children, while Sadie needs the financial security and freedom of a full-time teaching position.",
                image: "https://m.media-amazon.com/images/S/compressed.photo.goodreads.com/books/1743882229i/224003821.jpg",
                available: true,
                status: "new" // new arrival: new, Leaving soon: leaving, or null
            },

            {
                id: 25,
                title: "With You Forever",
                author: "Chloe Liese",
                genre: "Romance",
                year: "2021 SEP 14",
                rating: 9.0,
                category: "YA",
                pages: 384,
                location: "MLC/R/00025/YA",
                description: "Rooney Sullivan is sunshine incarnate and the antithesis of quiet, reserved Axel. He‚Äôs been able to hide his attraction to her until a party game gets out of hand and ends in an unexpected kiss. Months later, Rooney‚Äôs staying just next door to him for a cozy A-frame getaway and temptingly within reach.",
                image: "https://m.media-amazon.com/images/S/compressed.photo.goodreads.com/books/1690944101i/195036925.jpg",
                available: true,
                status: "" // new arrival: new, Leaving soon: leaving, or null
            },

            {
                id: 26,
                title: "Black Sheep",
                author: "Wattney Lander",
                genre: "Poetry",
                year: "2019 SEP 07",
                rating: 7.6,
                category: "Teens",
                pages: 117,
                location: "MLC/P/00026/TN",
                description: "Black Sheep is a collection of poetry and prose inspired by an awakening that lead to discover the sickness within a herd, perfect for those who have broke free from the unhealthy dynamics of their family.",
                image: "https://m.media-amazon.com/images/S/compressed.photo.goodreads.com/books/1677848265i/52141218.jpg",
                available: true,
                status: "" // new arrival: new, Leaving soon: leaving, or null
            },

            {
                id: 27,
                title: "Book Lovers",
                author: "Emily Henry",
                genre: "Romance",
                year: "2022 MAY 03",
                rating: 9.1,
                category: "YA",
                pages: 377,
                location: "MLC/R/00027/YA",
                description: "Nora Stephens‚Äô life is books‚Äîshe‚Äôs read them all‚Äîand she is not that type of heroine. Not the plucky one, not the laidback dream girl, and especially not the sweetheart. In fact, the only people Nora is a heroine for are her clients, for whom she lands enormous deals as a cutthroat literary agent, and her beloved little sister Libby.",
                image: "https://m.media-amazon.com/images/S/compressed.photo.goodreads.com/books/1638867089i/58690308.jpg",
                available: true,
                status: "" // new arrival: new, Leaving soon: leaving, or null
            },

            {
                id: 28,
                title: "The Love Hypothesis",
                author: "Ali Hazelwood",
                genre: "Romance",
                year: "2021 SEP 14",
                rating: 8.7,
                category: "Adult",
                pages: 400,
                location: "MLC/R/00028/A",
                description: "As a third-year Ph.D. candidate, Olive Smith doesn't believe in lasting romantic relationships‚Äîbut her best friend does, and that's what got her into this situation. Convincing Anh that Olive is dating and well on her way to a happily ever after was always going to take more than hand-wavy Jedi mind tricks: Scientists require proof. So, like any self-respecting biologist, Olive panics and kisses the first man she sees.",
                image: "https://m.media-amazon.com/images/S/compressed.photo.goodreads.com/books/1747519081i/56732449.jpg",
                available: true,
                status: "" // new arrival: new, Leaving soon: leaving, or null
            },

            {
                id: 29,
                title: "The Lion, the Witch and the Wardrobe",
                author: "C.S. Lewis",
                genre: "Fantasy",
                year: "1950 OCT 16",
                rating: 7.0,
                category: "Children",
                pages: 180,
                location: "MLC/F/00029/C",
                description: "They open a door and enter a world NARNIA...the land beyond the wardrobe, the secret country known only to Peter, Susan, Edmund, and Lucy...the place where the adventure begins. Lucy is the first to find the secret of the wardrobe in the professor's mysterious old house. At first, no one believes her when she tells of her adventures in the land of Narnia. But soon Edmund and then Peter and Susan discover the Magic and meet Aslan, the Great Lion, for themselves. In the blink of an eye, their lives are changed forever.",
                image: "https://m.media-amazon.com/images/S/compressed.photo.goodreads.com/books/1697079942i/132080146.jpg",
                available: true,
                status: "" // new arrival: new, Leaving soon: leaving, or null
            },

            {
                id: 30,
                title: "Prince Caspian",
                author: "C.S. Lewis",
                genre: "Fantasy",
                year: "1951 OCT 16",
                rating: 6.8,
                category: "Children",
                pages: 240,
                location: "MLC/F/00030/C",
                description: "A prince denied his rightful throne gathers an army in a desperate attempt to rid his land of a false king. But in the end, it is a battle of honor between two men alone that will decide the fate of an entire world.",
                image: "https://m.media-amazon.com/images/S/compressed.photo.goodreads.com/books/1308814880i/121749.jpg",
                available: true,
                status: "" // new arrival: new, Leaving soon: leaving, or null
            },
        ];


        // === uses firebase config creds to this ===
        const firebaseConfig = {
            apiKey: "AIzaSyBH6LVGPFkfx7NVUtGCLvvCC9MXcdZo7zk",
            authDomain: "mylibcom-co.firebaseapp.com",
            projectId: "mylibcom-co",
            storageBucket: "mylibcom-co.firebasestorage.app",
            messagingSenderId: "922343336014",
            appId: "1:922343336014:web:5d71dfadf665c9a6c73b1f",
            measurementId: "G-DCG0KW3N11"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore();

        // === GLOBAL USER STATE ===
        let currentUser = null;
        let userData = { wishlist: [], borrowed: [] };

        // Listen for auth changes
        auth.onAuthStateChanged((user) => {
            currentUser = user;
            if (user) {
                document.getElementById('authSection').innerHTML = `
                <div class="flex items-center gap-3">
                    <span class="text-sm text-slate-300 hidden md:block">Hi, ${user.displayName || user.email.split('@')[0]}</span>
                    <button onclick="logout()" class="text-xs bg-red-600 hover:bg-red-500 px-4 py-2 rounded">Logout</button>
                </div>
            `;
                document.getElementById('accountBtn').classList.remove('hidden');
                loadUserData();
            }

            else {
                document.getElementById('authSection').innerHTML = `
                <button onclick="showLoginModal()" class="text-emerald-400 hover:text-emerald-300 font-bold">Login / Register</button>
            `;
                document.getElementById('accountBtn').classList.add('hidden');
                userData = { wishlist: [], borrowed: [] };
            }
            renderBooks();
        });

        // --- State ---
        let currentFilter = 'All';
        let currentSort = 'newest';
        let searchQuery = '';

        // --- DOM Elements ---
        const bookGrid = document.getElementById('bookGrid');
        const searchInput = document.getElementById('searchInput');
        const mobileSearchInput = document.getElementById('mobileSearchInput');
        const sortSelect = document.getElementById('sortSelect');
        const genreFilters = document.getElementById('genreFilters');
        const bookCount = document.getElementById('bookCount');
        const noResults = document.getElementById('noResults');
        const modal = document.getElementById('bookModal');

        // --- Initialization ---
        function init() {
            renderBooks();

            // Search Listeners
            searchInput.addEventListener('input', (e) => handleSearch(e.target.value));
            mobileSearchInput.addEventListener('input', (e) => handleSearch(e.target.value));

            // Sort Listener
            sortSelect.addEventListener('change', (e) => {
                currentSort = e.target.value;
                renderBooks();
            });

            // Mobile Menu Toggle
            document.getElementById('mobileMenuBtn').addEventListener('click', () => {
                const panel = document.getElementById('mobileSearchPanel');
                panel.classList.toggle('hidden');
            });
        }

        // --- Core Logics ---
        function handleSearch(query) {
            searchQuery = query.toLowerCase();
            renderBooks();
        }

        function filterByGenre(genre) {
            currentFilter = genre;

            // Update visual button state
            const buttons = genreFilters.querySelectorAll('button');
            buttons.forEach(btn => {
                if (btn.innerText === genre) {
                    btn.classList.remove('bg-slate-800', 'text-slate-300');
                    btn.classList.add('bg-emerald-600', 'text-white', 'shadow-lg', 'shadow-emerald-500/30');
                } else {
                    btn.classList.add('bg-slate-800', 'text-slate-300');
                    btn.classList.remove('bg-emerald-600', 'text-white', 'shadow-lg', 'shadow-emerald-500/30');
                }
            });

            renderBooks();
        }

        function resetApp() {
            searchInput.value = '';
            mobileSearchInput.value = '';
            searchQuery = '';
            filterByGenre('All');
        }

        function getFilteredAndSortedBooks() {
            let filtered = books.filter(book => {
                const matchesGenre = currentFilter === 'All' || book.genre === currentFilter;
                const matchesSearch = book.title.toLowerCase().includes(searchQuery) ||
                    book.author.toLowerCase().includes(searchQuery);
                return matchesGenre && matchesSearch;
            });

            return filtered.sort((a, b) => {
                if (currentSort === 'newest') {
                    // Handling "Unknown" years by placing them last or treating as 0
                    let yearA = parseInt(a.year) || 0;
                    let yearB = parseInt(b.year) || 0;
                    return yearB - yearA;
                }
                if (currentSort === 'oldest') {
                    let yearA = parseInt(a.year) || 9999;
                    let yearB = parseInt(b.year) || 9999;
                    return yearA - yearB;
                }
                if (currentSort === 'rating') return b.rating - a.rating;
                if (currentSort === 'available') return (a.available === b.available) ? 0 : a.available ? -1 : 1;
                return 0;
            });
        }

        function renderBooks() {
            const displayBooks = getFilteredAndSortedBooks();

            bookCount.innerText = `Showing ${displayBooks.length} book${displayBooks.length !== 1 ? 's' : ''}`;
            bookGrid.innerHTML = '';

            if (displayBooks.length === 0) {
                bookGrid.classList.add('hidden');
                noResults.classList.remove('hidden');
            } else {
                bookGrid.classList.remove('hidden');
                noResults.classList.add('hidden');

                displayBooks.forEach(book => {
                    const card = document.createElement('div');
                    // Add visual cue for unavailable books in grid
                    const availabilityClass = book.available ? '' : 'card-unavailable';
                    card.className = `bg-slate-800 rounded-xl overflow-hidden shadow-lg border border-slate-700/50 card-hover transition-all duration-300 cursor-pointer fade-in ${availabilityClass}`;
                    card.onclick = () => openModal(book);

                    const categoryClass = `cat-${book.category}`;

                    // Badge logic
                    let badgeHTML = '';
                    if (!book.available) {
                        badgeHTML = `<div class="absolute top-3 right-3 px-3 py-1.5 text-xs font-bold rounded-lg shadow-md bg-red-600 text-white z-10 backdrop-blur-sm border border-red-400">CHECKED OUT</div>`;
                    }

                    else if (book.status === 'leaving') {
                        badgeHTML = `<div class="absolute top-3 right-3 px-3 py-1.5 text-xs font-bold rounded-lg shadow-md bg-yellow-600 text-white z-10 backdrop-blur-sm border border-yellow-400">LEAVING SOON</div>`;
                    }

                    else if (book.status === 'new') {
                        badgeHTML = `<div class="absolute top-3 right-3 px-3 py-1.5 text-xs font-bold rounded-lg shadow-md bg-emerald-600 text-white z-10 backdrop-blur-sm border border-emerald-400">NEW ARRIVAL</div>`;
                    }

                    // Handle missing images visually
                    const imageSrc = book.image;

                    card.innerHTML = `
                        <div class="relative h-64 overflow-hidden group">
                            ${badgeHTML}
                            <div class="absolute top-3 left-3 px-2 py-1 text-xs font-bold rounded shadow-md ${categoryClass} z-10 shadow-lg">${book.category}</div>
                            <img src="${imageSrc}" alt="${book.title}" 
                                class="w-full h-full object-cover transition-transform duration-500 group-hover:scale-110"
                                onerror="this.onerror=null; this.src='https://via.placeholder.com/300x450/1e293b/475569?text=No+Cover';">
                            <div class="absolute inset-0 bg-gradient-to-t from-slate-900 via-transparent to-transparent opacity-80"></div>
                        </div>
                        <div class="p-4 relative">
                            <div class="absolute -top-6 right-4 bg-slate-700 text-yellow-400 px-2 py-1 rounded-lg shadow-lg flex items-center gap-1 text-sm font-bold border border-slate-600">
                                <i class="fa-solid fa-star text-xs"></i> ${book.rating}
                            </div>
                            <div class="text-xs text-emerald-400 font-bold tracking-wider uppercase mb-1">${book.genre}</div>
                            <h3 class="text-lg font-bold text-white mb-1 line-clamp-2 leading-tight h-12">${book.title}</h3>
                            <p class="text-sm text-slate-400 mb-3 line-clamp-1">by ${book.author}</p>
                            
                            <div class="flex items-center justify-between text-xs text-slate-500 border-t border-slate-700 pt-3">
                                <span>${book.year}</span>
                                <span class="${book.available ? 'text-emerald-400' : 'text-red-400'} flex items-center gap-1">
                                    <i class="fa-solid fa-circle text-[8px]"></i>
                                    ${book.available ? 'Available' : 'Unavailable'}
                                </span>
                            </div>
                        </div>
                    `;
                    bookGrid.appendChild(card);
                });
            }
        }

        function openModal(book) {
            // Populate Modal Data
            document.getElementById('modalTitle').innerText = book.title;
            document.getElementById('modalAuthor').innerText = `by ${book.author}`;
            document.getElementById('modalGenre').innerText = book.genre;
            document.getElementById('modalRating').innerText = book.rating;
            document.getElementById('modalYear').innerText = book.year;
            document.getElementById('modalPages').innerText = `${book.pages} pages`;
            document.getElementById('modalDescription').innerText = book.description;
            document.getElementById('modalLocation').innerText = book.location;

            // Image handling
            const modalImg = document.getElementById('modalImage');
            const modalPlaceholder = document.getElementById('modalImagePlaceholder');
            modalImg.src = book.image;
            modalImg.style.display = 'block';
            modalPlaceholder.style.display = 'none'; // Hide placeholder initially

            // Category Styling
            const catEl = document.getElementById('modalCategory');
            catEl.innerText = book.category;
            // Remove old classes
            catEl.className = 'px-2 py-0.5 rounded text-xs font-bold shadow-sm';
            // Add specific color class defined in CSS
            catEl.classList.add(`cat-${book.category}`);

            // Status Logic
            const statusEl = document.getElementById('modalStatus');
            const actionBtn = document.getElementById('actionButton');

            actionBtn.innerHTML = `<i class="fa-solid fa-book-bookmark"></i> Borrow Book`;
            actionBtn.onclick = () => borrowBook(book);

            if (book.available) {
                statusEl.innerHTML = `<span class="status-available flex items-center gap-2"><i class="fa-solid fa-check-circle"></i> Available</span>`;
                actionBtn.className = "w-full text-white font-bold py-3 px-4 rounded-lg transition-colors flex items-center justify-center gap-2 uppercase tracking-wide text-sm shadow-lg bg-emerald-600 hover:bg-emerald-500 shadow-emerald-500/20";
                actionBtn.innerHTML = `<i class="fa-solid fa-book-bookmark"></i> Borrow Book`;
                actionBtn.onclick = () => borrowBook(book);
            }

            else {
                statusEl.innerHTML = `<span class="status-checked-out flex items-center gap-2"><i class="fa-solid fa-clock"></i>Not Available</span>`;
                actionBtn.className = "w-full text-white font-bold py-3 px-4 rounded-lg transition-colors flex items-center justify-center gap-2 uppercase tracking-wide text-sm shadow-lg bg-slate-700 cursor-not-allowed opacity-75";
                actionBtn.innerHTML = `<i class="fa-solid fa-bell"></i> Notify When Available`;
                actionBtn.onclick = () => {
                    alert(`We will notify you when "${book.title}" is returned.`);
                };
            }

            // Show Modal
            modal.classList.remove('hidden');
            document.body.style.overflow = 'hidden'; // Prevent background scrolling
        }

        function closeModal() {
            modal.classList.add('hidden');
            document.body.style.overflow = 'auto'; // Restore scrolling
        }

        // Close modal on Escape key
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape' && !modal.classList.contains('hidden')) {
                closeModal();
            }
        });

        let isLoginMode = true;

        function showLoginModal() {
            document.getElementById('authModal').classList.remove('hidden');
            isLoginMode = true;
            updateAuthUI();
        }

        function closeAuthModal() {
            document.getElementById('authModal').classList.add('hidden');
        }

        function toggleAuthMode() {
            isLoginMode = !isLoginMode;
            updateAuthUI();
        }

        function updateAuthUI() {
            if (isLoginMode) {
                document.getElementById('authTitle').innerText = "Login";
                document.getElementById('authMainBtn').innerText = "Login";
                document.getElementById('authMainBtn').onclick = login;
                document.getElementById('authToggleText').innerText = "Don't have an account?";
            } else {
                document.getElementById('authTitle').innerText = "Create Account";
                document.getElementById('authMainBtn').innerText = "Register";
                document.getElementById('authMainBtn').onclick = register;
                document.getElementById('authToggleText').innerText = "Already have an account?";
            }
        }

        function login() {
            const email = document.getElementById('authEmail').value;
            const password = document.getElementById('authPassword').value;

            auth.signInWithEmailAndPassword(email, password)
                .then(() => closeAuthModal())
                .catch(err => alert("Login failed: " + err.message));
        }

        function register() {
            const email = document.getElementById('authEmail').value;
            const password = document.getElementById('authPassword').value;

            if (password.length < 6) {
                alert("Password must be at least 6 characters");
                return;
            }

            auth.createUserWithEmailAndPassword(email, password)
                .then(cred => {
                    return cred.user.updateProfile({ displayName: email.split('@')[0] });
                })
                .then(() => {
                    // Create user document
                    return db.collection('users').doc(auth.currentUser.uid).set({
                        email: email,
                        wishlist: [],
                        borrowed: [],
                        joined: new Date()
                    });
                })
                .then(() => closeAuthModal())
                .catch(err => alert("Registration failed: " + err.message));
        }

        function logout() {
            auth.signOut();
        }

        // Initialize App
        init();

        //load userdata + lists + borrows
        async function loadUserData() {
            if (!currentUser) return;
            const doc = await db.collection('users').doc(currentUser.uid).get();
            userData = doc.exists ? doc.data() : { wishlist: [], borrowed: [] };
            renderAccountPage();
        }

        function isInWishlist(bookId) {
            return userData.wishlist.includes(bookId);
        }

        async function toggleWishlist(bookId, e) {
            e.stopPropagation();
            if (!currentUser) {
                alert("Please login to add to wishlist");
                showLoginModal();
                return;
            }

            const index = userData.wishlist.indexOf(bookId);
            if (index > -1) {
                userData.wishlist.splice(index, 1);
            } else {
                userData.wishlist.push(bookId);
            }

            await db.collection('users').doc(currentUser.uid).update({
                wishlist: userData.wishlist
            });

            renderBooks();
            if (document.getElementById('accountPage') && !document.getElementById('accountPage').classList.contains('hidden')) {
                renderAccountPage();
            }
        }

        // borrow machenism
        async function borrowBook(book) {
            if (!currentUser) {
                alert("Please login to borrow books");
                showLoginModal();
                return;
            }

            const entry = {
                id: book.id,
                title: book.title,
                author: book.author,
                borrowedAt: new Date().toISOString().split('T')[0]
            };

            // Remove if already borrowed
            userData.borrowed = userData.borrowed.filter(b => b.id !== book.id);
            userData.borrowed.push(entry);

            await db.collection('users').doc(currentUser.uid).update({
                borrowed: userData.borrowed
            });

            alert(`You have borrowed "${book.title}"!`);
            closeModal();
            renderAccountPage();
        }

        // Account pg rendering
        function showHome() {
            document.getElementById('accountPage').classList.add('hidden');
            document.querySelector('.max-w-7xl.mx-auto.px-4').classList.remove('hidden'); // main page
        }

        function showAccount() {
            if (!currentUser) {
                showLoginModal();
                return;
            }
            document.querySelector('.max-w-7xl.mx-auto.px-4').classList.add('hidden');
            document.getElementById('accountPage').classList.remove('hidden');
            renderAccountPage();
        }

        function renderAccountPage() {
            const wishlistDiv = document.getElementById('wishlistContainer');
            const borrowedDiv = document.getElementById('borrowedContainer');

            wishlistDiv.innerHTML = userData.wishlist.length === 0
                ? '<p class="text-slate-500">Your wishlist is empty</p>'
                : userData.wishlist.map(id => {
                    const b = books.find(x => x.id === id);
                    return `<div class="bg-slate-700 p-4 rounded-lg flex justify-between items-center">
                    <div>
                    <strong>${b.title}</strong><br>
                    <small class="text-slate-400">by ${b.author}</small>
                    </div>
                    
                    <button onclick="toggleWishlist(${id}, event)" class="text-red-500 text-xl">
                    <i class="fa-solid fa-heart"></i>
                    </button>
                    </div>`;
                }).join('');

            borrowedDiv.innerHTML = userData.borrowed.length === 0
                ? '<p class="text-slate-500">No books borrowed yet</p>'
                : userData.borrowed.map(b => {
                    const book = books.find(x => x.id === b.id);
                    return `<div class="bg-slate-700 p-4 rounded-lg">
                    <strong>${b.title}</strong><br>
                    <small class="text-slate-400">by ${b.author} ‚Ä¢ Borrowed on ${b.borrowedAt}</small>
                    </div>`;
                }).join('');
        }

        //G-Login Mechanism
        function googleSignIn() {
            const provider = new firebase.auth.GoogleAuthProvider();
            auth.signInWithPopup(provider)
                .then(() => {
                    // Auto creates user doc if not exists
                    const user = auth.currentUser;
                    db.collection('users').doc(user.uid).set({
                        email: user.email,
                        wishlist: [],
                        borrowed: [],
                        joined: new Date()
                    }, { merge: true });
                });
        }

        //Password reset mechanism
        function forgotPassword() {
            const email = prompt("Enter your email:");
            if (email) {
                auth.sendPasswordResetEmail(email)
                    .then(() => alert("Password reset email sent! Check your inbox."))
                    .catch(err => alert("Error: " + err.message));
            }
        }
    </script>
</body>
</html>
